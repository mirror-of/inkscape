2004-11-01  Kees Cook  <kees@outflux.net>

	* src/dialogs/align.cpp, src/dialogs/debugdialog.cpp: localized
	some missed strings.

2004-11-01  MenTaLguY  <mental@rydia.net>

	* share/icons/icons.svg: gave bulia's eye icons ids

2004-10-31  MenTaLguY  <mental@rydia.net>

	* src/util/glib-list.h: adaptor for glib lists

	* src/widgets/layer-selector.h, src/widgets/layer-selector.cpp:
	  save the repr next to the SPObject

2004-10-30  MenTaLguY  <mental@rydia.net>

	* src/util/list.h: more list cleanups and documentation

	* src/verbs.cpp: call sp_document_done() for layer verbs too

2004-10-30  Bryce Harrington <bryce@bryceharrington.org>

	* src/dialogs/item-properties.cpp, src/sp-object.h:  Cleaning up
	stubs, disabling some more of the desc code to prevent crash.	  
	The change to SPObject::label() broke the label editing code;
	fixing it.

2004-10-30  Kees Cook  <kees@outflux.net>

	* src/sp-metadata.cpp, src/sp-metadata.h, src/Makefile_insert,
	src/document.cpp, src/sp-object-repr.cpp, src/sp-object.cpp:
	I've created my very first SPObject!  SPMetadata is alive!  No
	more nasty hack to have it disappear from SVG Plain.  Mental
	won't have to take away my CVS access any more!  :)
	* inkscape2.nsi: update from Adib Taraben

2004-10-30  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/libnr/nr-matrix.cpp (nr_matrix_invert):
	  Fix for last commit to this file, which broke src==dest case.
	* src/libnr/nr-matrix-test.cpp: Add test cases for nr_matrix_invert.

2004-10-30  MenTaLguY  <mental@rydia.net>

	* src/widgets/layer-selector.cpp, src/widgets/layer-selector.h:
	  update when layers added/removed/reordered.

	* src/verbs.h, src/verbs.cpp: added "rename layer" verb.

2004-10-29  Kees Cook  <kees@outflux.net>

	* src/Makefile_insert, src/trace/Makefile_insert,
	src/util/Makefile_insert: distcheck cleanups.

2004-10-29  MenTaLguY  <mental@rydia.net>

	* src/widgets/layer-selector.cpp: default labels in italic

	* src/sp-object.h, src/sp-object.cpp: inkscape:label fixes

	* src/layer-fns.cpp: make ordering of layers complete; not just among
	                     siblings

	* src/util/list.h: documentation update

2004-10-29  Bryce Harrington <bryce@bryceharrington.org>

	* layer-fns.cpp:  documenting
	* layer-selector.cpp:  documenting & fixing funky widget resizing
	* object-ui.cpp, dialogs/item-properties.cpp, sp-object.h,
	  sp-object.cpp, widgets/layer-selector.cpp: add ability to set
	  inkscape:label from "Item Properties", remove id setting from
	  "Item Properties", switch to using
	  SPObject::label()/SPObject?::defaultLabel() in UI where object
	  ID is currently used.  Documenting.  Switching from "label" to
	  "inkscape:label" where appropriate.  Adding
	  visible()/setVisible() functions and activating checkbox.
	* dialogs/item-properties.cpp:  Adding title and desc boxes.
	  Adjusting layout of dialog a bit.  Changing to use of tables
	  instead of horiz/vert boxes for layout.  Setting to inactive
	  until some underlying bits get finished.
	
2004-10-29  Kees Cook  <kees@outflux.net>

	* src/dialogs/export.cpp: moved function-based static state variable
	  into the dialog state variables.  Closes bug #993447.
	* src/display/curve.cpp: fixed compile warning.
	* src/sp-namedview.cpp: wasn't ref counting correctly.  Closes #955020.

2004-10-29  Jon A. Cruz  <jon@joncruz.org>

	* src/sp-image.cpp, src/extension/internal/gdkpixbuf-input.cpp:
	  Refactoring filenames and file opening
	  Scales imported images if DPI is known and not 72 DPI. Fixes
	  #1029755

2004-10-29  MenTaLguY  <mental@rydia.net>

	* src/widgets/layer-selector.cpp, src/verbs.cpp:
	  unselect objects when layer is manually switched

2004-10-28  Kees Cook  <kees@outflux.net>

	* src/document-undo.cpp, src/document.cpp, src/sp-namedview.cpp,
	  src/sp-text.cpp, src/dialogs/desktop-properties.cpp,
	  src/dialogs/export.cpp, src/extension/input.cpp, 
	  src/extension/output.cpp, src/extension/system.cpp:
	  Fixing calls to sp_document_set_undo_sensitive to correct allow for
	  nesting, as suggested by mental.  Found while tracking down bug
	  #1030436.

2004-10-28  MenTaLguY  <mental@rydia.net>

	* src/util/list.h: cleanups of list class.  I think, aside from
	  documentation and maybe fixes for g++ 3.4 (if required), this
	  is the last set of changes I will need to make.

	* src/sp-item.cpp, src/splivarot.cpp, src/util/reverse-list.h,
	  src/util/filter-list.h, src/util/map-list.h:
	  adjust for changes in the list class' interface

	* src/desktop.cpp, src/sp-desktop-widget.h:
	  removed old layer selector and added SPDesktop::itemIsHidden()

	* src/widgets/layer-selector.cpp, src/widgets/layer-selector.h:
	  more work; it's now at least as functional as the old selector it
	  replaces
	  
2004-10-27  Kees Cook  <kees@outflux.net>

	* src/libnr/nr-point.h: use NR::X and NR::Y instead of "0" and "1".
	* src/dialogs/export.cpp: stack/register weirdness requires a function
	  call to get true == comparison of NR::Rect's.  Closes bug #1048614.
	* src/dialogs/align.cpp: saving erased iterator.  Closes bug #1054270.
	* share/extensions/ill2svg.pl: added strict, warnings, and detection
	  of Image::Magick module.  Closes bug #990659.
	* src/dialogs/find.h, src/dialogs/find.cpp: removed unfinished new
	  find dialog instantiation.  Closes bug #1048802.

2004-10-27  Carl Hetherington  <inkscape@carlh.net>

	* src/extension/output.cpp: better fix for 1004134 after advice
	from Ted.

2004-10-26  Carl Hetherington  <inkscape@carlh.net>

	* src/extension/output.cpp: don't reset modified flag until after
	save has happened, in case it fails.  Fixes 1004134.

	* src/livarot/ShapeSweep.cpp: fix a typo in my cleanups.  Fixes
	1048151.

2004-10-25  Bryce Harringotn <bryce@bryceharrington.org>

	* file.cpp, file.h, dialogs/export.cpp: Adding error return logic
	  for png export code so that failure to write can be tracked.
	  Adding an error dialog for when this occurs.  Fixes bug 1038932. 

	* extension/system.cpp:  Changing sp_ui_error_dialog to g_warning
	  so won't crash when running from commandline.  Fixes bug
	  1000350. 

	* inkscape.cpp, inkscape.h, main.cpp, dialogs/filedialog.cpp:
	  Adding Inkscape::Application::use_gui flag as temporary hack to
	  prevent gui dialogs from being used when running from
	  commandline.  Fixes bug 1045067.
	
2004-10-26  Carl Hetherington  <inkscape@carlh.net>

	* src/livarot/PathCutting.cpp: fix a couple of bugs that I
	introduced that cause crashes on cut path.

2004-10-25  Kees Cook  <kees@outflux.net>

	* src/sp-object.cpp: nasty hack to not export metadata on "Plain SVG".
	  I promise I'll fix this with a proper SPObject soon.

2004-10-25  Jon A. Cruz  <jon@joncruz.org>
	* src/file.cpp, src/file.h, src/inkscape.cpp, src/sp-image.cpp,
	src/uri.cpp, src/uri.h, src/dialogs/filedialog.cpp,
	src/extension/input.cpp, src/extension/implementation/script.cpp,
	src/extension/internal/pov-out.cpp, src/extension/internal/ps.cpp,
	src/extension/internal/win32.h, src/extension/plugin/gimpgrad.cpp,
	src/helper/png-write.cpp, src/trace/imagemap.cpp, src/xml/repr-io.cpp:

	Refactoring filenames and file opening

2004-10-24  MenTaLguY  <mental@rydia.net>

	* src/Makefile.am: added/removed files

	* src/util/copy-list.h: nobody's using it right now, get rid of it

	* src/traits/copy.h, src/traits/list-copy.h:
	  traits for determining the type to make a copy of a value

	* src/sp-item.cpp, src/util/filter-list.h src/util/map-list.h,
	  src/util/reverse-list.h, src/widgets/layer-selector.cpp
	  src/xml/sp-repr-action.cpp:

	  let the list functions infer their own result type (where possible)

	* src/util/forward-pointer-iterator.h: its value type is a reference

2004-10-23  MenTaLguY  <mental@rydia.net>

	* src/desktop.cpp: removed vertical usize limits on statusbar

	* src/widgets/layer-selector.cpp, src/widgets/layer-selector.h:
	  more layer selector work; simplfied model and customized CellRenderer
	  settings a bit

	* src/attributes.cpp, src/attributes.h, src/sp-object.cpp, src/sp-object.h:
	  add inkscape:label attribute

	* src/file.cpp, src/sp-anchor.h, src/sp-animation.h, src/sp-chars.h,
	  src/sp-clippath.h, src/sp-conn-end.cpp, src/sp-defs.h, src/sp-ellipse.h,
	  src/sp-gradient.h, src/sp-guide.h, src/sp-image.h, src/sp-line.h,
	  src/sp-linear-gradient.h, src/sp-marker.h, src/sp-mask.h,
	  src/sp-namedview.h, src/sp-object-group.h, src/sp-offset.h, src/sp-path.h,
	  src/sp-pattern.h, src/sp-polygon.h, src/sp-polyline.h,
	  src/sp-radial-gradient.h, src/sp-rect.cpp, src/sp-rect.h, src/sp-root.h,
	  src/sp-spiral.h, src/sp-star.h, src/sp-stop.h, src/sp-string.h,
	  src/sp-symbol.h, src/sp-text.h, src/sp-tspan.h, src/sp-use.h,
	  src/sp-offset.cpp, src/sp-shape.h:

	  make inheritance actual

2004-10-23  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/libnr/*: Move some things from nr-matrix-ops.h to new files.

	* src/libnr/nr-point-fns.h, src/libnr/nr-point-fns.cpp:
	  New function is_zero.  Move is_unit_vector here
	  (was private to sp-spiral.cpp).

	* src/display/bezier-utils-test.cpp: Disable a test, replacing with a
	  todo printf and adding a comment explaining.

2004-10-22  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/pencil-context.cpp: Ensure that data points array p is uniqued
	  and contains no NaNs. 

	* src/libnr/nr-point-fns.cpp (LInfty): Fix bug with NaN coordinates:
	  return NaN (rather than unspecified behaviour).
	* src/libnr/nr-point-fns-test.cpp: Add test cases for L1,L2,LInfty
	  handling of NaN.

	* src/pencil-context.cpp: Fix bug: undesirable interactions between
	  snapping and snap-to-anchor.

2004-10-21  MenTaLguY  <mental@rydia.net>

	* src/desktop.cpp: SPDesktop::currentRoot() should pull from
	  the current layer hierarchy just like SPDesktop::currentLayer();
	  doubly so, since currently when switching documents the layer hierarchy
	  is updated before the document is switched

	* src/util/Makefile_insert, src/util/copy-list.h: add list copy thingy

	* src/util/list.h: add rest()

	* src/util/reverse-list.h: bug fixes to reverse_list_in_place()

	* src/widgets/layer-selector.cpp, src/widgets/layer-selector.h:
	  more work on layer selector

2004-10-21  Carl Hetherington  <inkscape@carlh.net>

	* src/livarot/Path.cpp, src/livarot/Path.h,
	src/livarot/PathConversion.cpp, src/livarot/PathCutting.cpp,
	src/livarot/PathOutline.cpp, src/livarot/PathSimplify.cpp,
	src/livarot/ShapeMisc.cpp: excise separate path description data
	structure.

	* src/livarot/Path.h, src/livarot/Path.cpp,
	src/livarot/PathConversion.cpp, src/livarot/PathCutting.cpp,
	src/livarot/PathOutline.cpp, src/livarot/PathSimplify.cpp,
	src/livarot/ShapeMisc.cpp, src/livarot/livarot-forward.h: move
	path description structs into their own files, and rename a few
	member variables.

	* src/livarot/Path.h, src/livarot/PathConversion.cpp,
	src/livarot/PathOutline.cpp: remove some unused functions.

2004-10-20  Carl Hetherington  <inkscape@carlh.net>

	* src/livarot/Path.cpp: fix for 1050379, and probably lots of
	others.

	* src/livarot/Path.h, src/livarot/PathOutline.cpp: bug fix for a
	previous commit.

	* src/livarot/Path.cpp: fix a memory leak.

2004-10-19  Carl Hetherington  <inkscape@carlh.net>

	* src/livarot/Path.h, src/livarot/PathSimplify.cpp: more
	simplification cleanups.

	* src/livarot/PathStroke.cpp: coding style cleanups.

	* src/livarot/Path.h, src/livarot/PathSimplify.cpp,
	src/livarot/PathStroke.cpp: more cleanups; don't modify Path::pts
	and Path::nbPt.

	* src/livarot/Path.cpp, src/livarot/Path.h,
	src/livarot/PathConversion.cpp, src/livarot/PathCutting.cpp,
	src/livarot/PathSimplify.cpp, src/livarot/PathStroke.cpp: use a
	std::vector for Path::pts.

2004-10-18  Carl Hetherington  <inkscape@carlh.net>

	* src/livarot/Path.h, src/livarot/PathSimplify.cpp: coding style
	and const cleanups.

	* src/livarot/PathSimplify.cpp: some very minor cleanups, and
	temporary comments for myself.

	* src/livarot/PathConversion.cpp: coding style cleanups.

	* src/livarot/PathConversion.cpp: fix for bug 1048827.

	* src/livarot/Path.h, src/livarot/PathSimplify.cpp: clean up
	simplification code. 

2004-10-17  MenTaLguY  <mental@rydia.net>

	* share/templates/Makefile.am, share/templates/layers.svg:
	  added a layer template 

	* src/widgets/layer-selector.h, src/widgets/layer-selector.cpp:
	  more layer selector work

	* src/util/filter-list.h, src/util/Makefile_insert: 
	  added filter_list()

2004-10-15  Carl Hetherington  <inkscape@carlh.net>

	* src/livarot/PathSimplify.cpp: remove #ifdef
	pseudo_douglas_pecker code that wasn't being used.

2004-10-15  MenTaLguY  <mental@rydia.net>

	* src/view.h: removed obsolete status message functions

	* src/attributes.h: remove unused #define

	* src/sp-object.cpp: fix for bug #1048268 (inkscape:collect being written
	  in "plain SVG" files)

	* src/sp-item.h, src/sp-item.cpp: added isLocked() and isHidden()
	  predicates

	* src/sp-item.cpp, src/sp-style.cpp: basic support for visibility CSS
	  property

2004-10-14  Ted Gould  <ted@gould.cx>

	* share/extension/*.inkmod -> *.inx
	src/extension/init.cpp

	Changing the filename extension that is used to identify Inkscape
	extensions to the one specified in the design document.

2004-10-14  MenTaLguY  <mental@rydia.net>

	* src/util/list.h: more 3.4 fixes

2004-10-13  MenTaLguY  <mental@rydia.net>

	* src/util/list.h, src/util/forward-pointer-iterator.h:

	  fixes to (hopefully) build with g++ 3.4 (and generally be less evil
	  anyway)

2004-10-14  Carl Hetherington <inkscape@carlh.net>

	* src/livarot/int-line.cpp: coding style cleanups.

	* src/livarot/float-line.cpp, src/livarot/float-line.h:
	refactoring, removal of dead code.

	* src/display/guideline.cpp, src/display/guideline.h: coding style
	cleanups.

	* src/livarot/Path.cpp, src/livarot/Path.h,
	src/livarot/PathConversion.cpp, src/livarot/PathCutting.cpp,
	src/livarot/PathSimplify.cpp, src/livarot/PathStroke.cpp: merge
	Path::path_lineto and Path::path_lineto_b.

2004-10-14  Carl Hetherington <inkscape@carlh.net>

	* src/Path.cpp, src/Path.h, src/PathConversion.cpp,
	src/PathCutting.cpp, src/PathOutline.cpp, src/PathSimplify.cpp,
	src/ShapeMisc.cpp: use a vector of pointers for Path::descr_cmd.

	* src/livarot/Ligne.cpp, src/livarot/Ligne.h,
	src/livarot/int-line.cpp, src/livarot/int-line.h,
	src/livarot/float-line.cpp, src/livarot/float-line.h,
	src/livarot/livarot-forward.h, src/livarot/ShapeRaster.cpp,
	src/sp-flowregion.cpp, src/display/canvas-bpath.cpp,
	src/display/nr-arena-glyphs.cpp, src/display/nr-arena-shape.cpp,
	src/display/sp-ctrlline.cpp, src/libnrtype/FlowDest.cpp,
	src/libnrtype/RasterFont.cpp: split Ligne into float-line and
	int-line.

	* src/libnrtype/FlowDest.cpp, src/libnrtype/RasterFont.cpp,
	src/libnrtype/raster-position.h, src/livarot/float-line.cpp,
	src/livarot/float-line.h, src/livarot/int-line.cpp: use
	std::vector for arrays in FloatLigne.

	* src/livarot/float-line.cpp, src/livarot/float-line.h: remove
	lots of dead code.  Make some methods private.

2004-10-12  MenTaLguY  <mental@rydia.net>

	* src/Makefile.am: added files

	* src/layer-fns.cpp, src/sp-item.cpp: use iterators, simplifying code

	* src/sp-object.cpp, src/splivarot.cpp: adapt to new version of 
	  Inkscape::Algorithms::longest_common_suffix

	* src/sp-object.h, src/sp-repr-iterators.h: add new iterator classes

	* src/algorithms/find-last-if.h: add counterpart of std::find_if

	* src/algorithms/longest-common-suffix.h: rewrite to use iterators

	* src/algorithms/longest-prefix.h, src/algorithms/longest-suffix.h,
	  src/algorithms/shortest-prefix.h, src/algorithms/shortest-suffix.h:

	  removed; these algorithms are no longer necessary when using
	  iterators

	* src/traits/list.h: no longer needed

	* src/traits/reference.h: add "Pointer" member type

	* src/util/Makefile_insert: shuffled files

	* src/util/list.h: reworked Inkscape::Util::List to be a "handle" type
	  that can also be used as an STL iterator

	* src/util/forward-pointer-iterator.h: treat a pointer as an iterator,
	  given a base pointer type and a type which defines the iteration
	  strategy

	* src/util/map.h: obsolete

	* src/util/map-list.h: iterator-based implementation

	* src/traits/tree-iterator.h: no longer necessary (superceded by
	  specific applications of Inkscape::Util::ForwardPointerIterator)

	* src/sp-object-tree-iterator.h, src/util/parent-axis.h,
	  src/util/sibling-axis.h: obsolete

	* src/util/map.h, src/util/reverse.h: obsolete

	* src/util/map-list.h, src/util/reverse-list.h:
	  iterator-based implementations

	* src/xml/Makefile_insert: added file

	* src/xml/repr.h: removed old tree iterator stuff

	* src/xml/sp-repr-action.cpp, src/xml/sp-repr-action.h: use new
	  pointer iterator facility

	* src/xml/sp-repr-iterators.h: pointer iterators for SPRepr

2004-10-12  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/display/bezier-utils.h, src/display/bezier-utils.cpp
	  (sp_bezier_fit_cubic_r, sp_bezier_fit_cubic_full): Change the meaning
	  of the last parameter: was max_depth, now lg_max_beziers, with the
	  relationship lg_max_beziers = max_depth + 1.  Callers updated.

	* src/xml/repr.cpp (sp_repr_change_order):
	  Add g_return_if_fail for some conditions that would break structural
	  integrity, and add a TODO comment indicating incompleteness.
	  Use sp_repr_prev function.

	* src/xml/repr-get-children.h, src/xml/repr-get-children.cpp
	  (sp_repr_prev_sibling): Rename to sp_repr_prev for consistency
	  with sp_repr_next.  Don't consider it an error for child to be
	  NULL or parentless.  Callers updated.

	* src/draw-context.cpp (spdc_concat_colors_and_flush,
	  spdc_flush_white): Misc readability cleanups.

	* src/display/curve.cpp (sp_curve_reverse): Fix a bug where the
	  reversed curve wrongly included a trailing moveto command.  (Bug
	  introduced in my 2004-09-05 change: one of the callers I didn't
	  know how to cause to run.)

2004-10-12  Ted Gould  <ted@gould.cx>

	* share/extensions/ai_input.inkmod, share/extensions/ai_output.inkmod,
	share/extensions/dia.inkmod, share/extensions/dropshadow.inkmod,
	share/extensions/eps_input.inkmod, share/extensions/epsi_output.inkmod,
	share/extensions/gimpgrad.inkmod, share/extensions/ps_input.inkmod,
	share/extensions/roundhole.inkmod, share/extensions/sk_input.inkmod,
	share/extensions/svgz_input.inkmod, share/extensions/svgz_output.inkmod,
	share/extensions/txt2svg.inkmod, share/extensions/wmf_input.inkmod,
	src/extension/dependency.cpp, src/extension/dependency.h,
	src/extension/extension.cpp, src/extension/init.cpp:

	Moving all of the dependency stuff from the scripts, up to the root
	extension level.  This means that everyone can have dependencies, and
	dependency checking (a good thing).  This makes use of the new
	'Dependency' class that is also in the extension directory.

2004-10-11  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/pencil-context.cpp (sp_pencil_context_root_handler): Split into
	  many functions, fixing some illegal union aliasing along the way (as
	  was done for sp_pen_context_root_handler).

	* src/modifier-fns.h: New file of inline functions based on macros.h
	  MOD__CTRL etc. macros.
	* src/Makefile_insert: Add the new file.

	* src/pen-context.h: Change size of p array from SP_DRAW_MAX_POINTS to
	  5 now that we aren't sharing with SPPencilContext.

	* src/draw-context.cpp, src/draw-context.h, src/pen-context.cpp,
	  src/pen-context.h, src/pencil-context.cpp, src/pencil-context.h:
	  Move npoints,p from SPDrawContext to both SPPenContext and
	  SPPencilContext.

	* src/draw-context.cpp, src/draw-context.h: Split off new files
	  pen-context.h, pen-context.cpp, pencil-context.h, pencil-context.cpp,
	  draw-anchor.h, draw-anchor.cpp.
	* src/Makefile_insert: Add the new files.

2004-10-10  Ted Gould  <ted@gould.cx>

	* src/event-context.cpp, src/file.cpp, src/file.h, src/print.cpp,
	src/print.h, src/selection-chemistry.h, src/sp-image.cpp, src/sp-item.cpp,
	src/sp-marker.cpp, src/sp-root.cpp, src/sp-shape.cpp, src/sp-symbol.cpp,
	src/tools-switch.cpp, src/dialogs/export.cpp, src/dialogs/filedialog.cpp,
	src/extension/Makefile_insert, src/extension/db.cpp,
	src/extension/dependency.cpp, src/extension/dependency.h,
	src/extension/effect.cpp, src/extension/effect.h,
	src/extension/extension-forward.h, src/extension/extension.cpp,
	src/extension/extension.h, src/extension/input.cpp, src/extension/input.h,
	src/extension/output.cpp, src/extension/output.h, src/extension/print.cpp,
	src/extension/print.h, src/extension/system.cpp,
	src/extension/internal/eps-out.cpp, src/extension/internal/ps.cpp,
	src/extension/internal/svg.cpp, src/libnrtype/FlowResOut.cpp:

	Splitting out the different types of extensions into their own files so
	that the overall dependencies can be reduced.  Caused a ripple through
	lots of other files.  Hopefully the dependency situation is better now.

2004-10-10  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/draw-context.cpp:
	  Change xp,yp file globals to NR::Point pen_draw_origin_w.

	* src/draw-context.cpp (sp_pen_context_root_handler):
	  Split into many routines.  Fix some illegal union member aliasing.
	  (pen_handle_key_press): Minor code cleanups in backspace handling.
	  (pen_handle_motion_notify): Make tolerance var local instead of
	  file-global.  (This transformation is applicable to many
	  dragtolerance users.)

	* src/draw-context.cpp (spdc_endpoint_snap_handle):
	  Change argument type from SPDrawContext to SPPenContext, and
	  specialize definition accordingly.  Caller updated.

	* src/draw-context.h: Change red_curve_is_valid from char to bool.
	* src/draw-context.cpp: Change red_curve_is_valid assignments from
	  0x00/0x01 to false/true (using find & replace).

2004-10-07  Carl Hetherington  <inkscape@carlh.net>

	* src/nr-object.cpp, src/nr-object.h: coding style and const
	fixes.

	* src/nr-rect.cpp: added a doxygen comment.  Some coding style
	fixes.

	* src/sp-paint-server.cpp: coding style fixes.

	* src/nr-arena-item.cpp, src/nr-arena-item.h: move a comment to
	the .cpp file and make it doxygen-style.

	* src/livarot/Path.cpp: coding style cleanups.  Add an assert to
	Path::Transform().

	* src/livarot/Path.cpp, src/livarot/Path.h: fix some archaic
	notation.

	* src/livarot/Ligne.cpp: coding style cleanups.

	* src/livarot/PathOutline.cpp, src/livarot/Path.h: fix a rather
	nasty hack in the outlining code.

	* src/livarot/Path.cpp, src/livarot/Path.h,
	src/livarot/PathConversion.cpp, src/livarot/PathCutting.cpp,
	src/livarot/PathOutline.cpp, src/livarot/PathSimplify.cpp,
	src/livarot/ShapeMisc.cpp, src/splivarot.cpp, src/sp-offset.cpp:
	use std::vector for Path::descr_cmd.

	* src/livarot/Path.cpp, src/livarot/Path.h,
	src/livarot/PathConversion.cpp, src/livarot/PathCutting.cpp,
	src/livarot/PathOutline.cpp, src/livarot/PathSimplify.cpp,
	src/livarot/ShapeMisc.cpp: getType() and setType() in Path::path_descr.
	
2004-10-07  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-object-repr.cpp (sp_repr_type_lookup): Distinguish between XML
	  element name and sodipodi:type attribute value: use a separate table
	  for each.
	* src/sp-object-repr.h, src/sp-object-repr.cpp (sp_object_type_lookup):
	  Don't export this function.  (Also rename it to name_to_gtype and
	  change its definition for separate tables.)

2004-10-03  Kees Cook  <kees@outflux.net>

	* src/dialogs/rdf.cpp, src/dialogs/repr-util.cpp, src/dialogs/repr.h:
	  Since "dc:title" can appear at multiple XML levels, a way to
	  control max depth in searching was added.  (Closes bug #1009290)

2004-09-30  MenTaLguY  <mental@rydia.net>

	* src/widgets/document-tree-model.cpp:
	  more bug fixes
	
	* src/widgets/layer-selector.cpp, src/widgets/layer-selector.h:
	  get the layer selector sort of in more order

2004-09-28  Ted Gould  <ted@gould.cx>

	* src/verbs.cpp, src/verbs.h, src/view.cpp:

	Making it so that actions get deleted as views get destroyed.

2004-09-27  Ted Gould  <ted@gould.cx>

	* src/desktop.h, src/forward.h, src/interface.cpp, src/interface.h,
	src/select-toolbar.cpp, src/shortcuts.cpp, src/shortcuts.h,
	src/toolbox.cpp, src/toolbox.h, src/verbs.cpp, src/verbs.h,
	src/dialogs/align.cpp, src/dialogs/align.h,
	src/dialogs/desktop-properties.cpp, src/dialogs/display-settings.cpp,
	src/dialogs/export.cpp, src/dialogs/find.cpp,
	src/dialogs/item-properties.cpp, src/dialogs/object-properties.cpp,
	src/dialogs/text-edit.cpp, src/dialogs/transformation.cpp,
	src/dialogs/xml-tree.cpp, src/helper/action.cpp, src/helper/action.h:

	Wow, alot of files changed.  The ones that changed the most are
	verb.cpp and verb.h, which are almost entirely different.  What happened
	here is the the verbs were made object oriented.  So, as the verbs
	are built into everything, lots of files changed.  Now the code
	for the verbs is much cleaner, and I think a little bit faster.
	Also, it will be easier to extend the verbs for use in effects.

2004-09-26  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/libnr/nr-matrix.h, src/libnr/nr-matrix.cpp:
	  Get rid of operator NR::translate(), which was allowing
	  *implicit* (and typically lossy) conversion to NR::translate,
	  and which made a bug hard to find.

	* src/sp-gradient-test.cpp: New unit test file.  I believe this is the
	  first test that tests an SPObject.
	* src/Makefile_insert, src/Makefile.am: Invoke the new test.

2004-09-24  MenTaLguY <mental@rydia.net>

	* src/selection-chemistry.cpp:
	
	  "select all" and "clear" now operate on the current layer rather than on
	  the document root

	* src/verbs.cpp, src/shortcuts.cpp, layer-fns.cpp, src/sp-item.cpp:
	
	  keyboard shortcuts and fixes for layer verbs

2004-09-23  MenTaLguY <mental@rydia.net>

	* src/message-stack.h, src/message-stack.cpp:

	  return id of flashed messages so they are cancellable

	* src/message-context.h, src/message-context.cpp:

	  message context flashes now supercede one another, as regular
	  messages do (they do not supercede regular messages though)

	* src/interface.cpp, src/layer-fns.cpp, src/layer-fns.h, src/verbs.cpp:

	  initial stab at layers menu; not everything works the way it should
	  quite yet

	* src/message-context.h, src/message-context.cpp:

	  added flash methods to Inkscape::MessageContext

	* src/gc-core.h, src/display/nr-arena-glyphs.cpp, src/display/nr-arena-group.cpp,
	  src/display/nr-arena-item.cpp, src/display/nr-arena-item.h,
	  src/display/nr-arena-shape.cpp, src/libnr/nr-object.cpp, src/libnr/nr-object.h,

	  eliminate more sources of leaks; managed objects shouldn't use refcounts
	  among themselves

	* src/xml/repr.cpp: don't nuke log pointer

2004-09-21  MenTaLguY <mental@rydia.net>

	* src/gc-finalized.h: fix for stupid bug preventing finalizable objects
	  from being collected

	* src/Makefile_insert, src/gc.cpp, src/gc-core.h:
	  move Inkscape::GC::init out-of-line, and funnel GC warnings through
	  glib

2004-09-21  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-marker.h, src/sp-marker.cpp (sp_marker_show_instance):
	  Change to using NR::Matrix instead of NRMatrix.  Update caller.

	* src/sp-gradient.cpp (sp_gradient_get_g2d_matrix,
	  sp_gradient_get_gs2d_matrix, sp_gradient_set_gs2d_matrix):
	  New NR::Matrix/NR::Rect versions of existing functions.

	* src/libnr/nr-matrix-translate-ops.h (operator/): New function.

	* src/libnr/nr-matrix-scale-ops.cpp: New file.
	* src/libnr/nr-matrix-scale-ops.h (operator/(Matrix,scale)):
	  New function.

2004-09-20  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-gradient.h: Change gradientTransform from NRMatrix to
	  NR::Matrix.  Users updated.

	* src/Makefile.am (EXTRA_DIST), Makefile_insert
	  dialogs/Makefile_insert extension/implementation/Makefile_insert
	  extension/internal/Makefile_insert helper/Makefile_insert
	  livarot/Makefile_insert (blah_SOURCES):
	  Add some .h files for `make dist'.

2004-09-19  MenTaLguY <mental@rydia.net>

	* src/gc-core.h: don't defer finalizers

	* src/gc-core.h: bump up free space divisor -- collections should
	  happen ~32x more frequently

2004-09-19  Carl Hetherington <inkscape@carlh.net>

	* src/display/canvas-bpath.cpp, src/display/nr-arena-shape.cpp,
	src/display/sp-ctrlline.cpp, src/libnrtype/RasterFont.cpp,
	src/livarot/Shape.h, src/livarot/ShapeRaster.cpp: remove some
	unused parameters from calls to raster code.

	* src/livarot/ShapeRaster.cpp: coding style cleanups.

	* src/livarot/Shape.h, src/livarot/ShapeRaster.cpp: factored out
	_updateIntersection().

	* src/livarot/AVL.cpp, src/livarot/AVL.h: remove DblLinked.  Cleanups.

2004-09-18  MenTaLguY <mental@rydia.net>

	* src/dialogs/filedialog.cpp: unref the preview document we created

2004-09-18  Carl Hetherington <inkscape@carlh.net>

	* src/livarot/AVL.cpp, src/livarot/AVL.h,
	src/livarot/DblLinked.cpp, src/livarot/DblLinked.h,
	src/livarot/LivarotDefs.h, src/livarot/ShapeRaster.cpp,
	src/livarot/ShapeSweep.cpp, src/livarot/sweep-tree.cpp,
	src/livarot/sweep-tree.h, src/sweep-event.h: replace leftFoo and
	rightFoo with foo[2] in a few places.  Associated cleanups.

	* src/livarot/Shape.h: use Side rather than a bool for
	TesteIntersection.  Add some methods.  Remove some unused variables.

	* src/livarot/ShapeSweep.cpp: simplify TesteIntersection with use
	of Side.

	* src/livarot/sweep-event.h: const fix.

	* src/livarot/sweep-event.cpp: simplifications with use of Side.

	* src/sp-offset.cpp, src/splivarot.cpp, src/livarot/Shape.cpp,
	src/livarot/ShapeMisc.cpp, src/ShapeSweep.cpp: lastA/firstA in
	Shape::dg_point -> incidentEdge[2].

	* src/livarot/LivarotDefs.h: add FirstOrLast enum.

	* src/livarot/ShapeRaster.cpp: coding style cleanups and refactoring.

2004-09-17  Carl Hetherington <inkscape@carlh.net>

	* src/livarot/Shape.h: use a std::vector for Shape::chgts.  Add
	clearIncidenceData();

	* src/livarot/Shape.cpp: Add clearIncidenceData().  Initialise
	iData in the constructor.

	* src/livarot/ShapeSweep.cpp: coding style cleanups.  Use a
	std::vector for Shape::chgts.  Use clearIncidenceData().

2004-09-16  Carl Hetherington <inkscape@carlh.net>

	* src/livarot/ShapeUtils.h, src/livarot/ShapeSweepUtils.cpp,
	src/livarot/sweep-tree.cpp, src/livarot/sweep-tree.h,
	src/livarot/sweep-event.cpp, src/livarot/sweep-event.h,
	src/livarot/Shape.h: split up ShapeUtils.h and ShapeSweepUtils.cpp
	into two separate files.

	* src/livarot/Shape.cpp, src/livarot/Shape.h,
	src/livarot/ShapeRaster.cpp, src/livarot/ShapeSweep.cpp,
	src/livarot/sweep-event.cpp, src/livarot/sweep-event.h:
	Make SweepEventQueue into a proper class, and move some static
	methods from SweepEvent into it.

	* src/livarot/ShapeSweep.cpp, src/livarot/sweep-event.cpp,
	src/livarot/sweep-event.h, src/livarot/sweep-tree.cpp: make member
	variables of SweepEventQueue private.

	* src/livarot/Shape.cpp, src/livarot/Shape.h,
	src/livarot/sweep-tree.cpp, src/livarot/sweep-tree.h,
	src/livarot/ShapeRaster.cpp, src/livarot/ShapeSweep.cpp: make
	SweepTreeList into a proper class.

	* src/livarot/Shape.cpp, src/livarot/Shape.h,
	src/livarot/ShapeRaster.cpp, src/livarot/ShapeSweep.cpp: remove
	unnecessary Shape::_has_sweep_data.

	* src/livarot/Shape.h, src/livarot/Shape.cpp,
	src/livarot/ShapeSweep.cpp: use an enum rather than an int.

2004-09-16  MenTaLguY <mental@rydia.net>

	* src/render/stroke.cpp: a little more work on the stroking code

	* src/widgets/document-tree-model.cpp, src/widgets/document-tree-model.h,
	  src/widgets/layer-selector.cpp, src/widgets/layer-selector.h,
	  src/desktop.cpp, src/sp-desktop-widget.h:

	  work on new gtkmm-ified layer selector

2004-09-15  Carl Hetherington <inkscape@carlh.net>

	* src/display/canvas-bpath.cpp, src/display/nr-arena-shape.cpp
	src/display/sp-ctrlline.cpp, src/libnrtype/FlowDest.cpp,
	src/libnrtype/RasterFont.cpp, src/livarot/Shape.h,
	src/livarot/ShapeRaster.cpp Remove unused parameters in
	Shape::{Begin,End}{,Quick}Raster

	* src/livarot/ShapeRaster.cpp: coding style cleanups.

	* src/livarot/Shape.cpp, src/livarot/Shape.h,
	src/livarot/ShapeRaster.cpp, src/livarot/ShapeSweep.cpp: Factor
	out initialisePointData() and initialiseEdgeData()

2004-09-14  Carl Hetherington <inkscape@carlh.net>

	* src/display/canvas-bpath.cpp, src/display/nr-arena-shape.cpp,
	src/livarot/Shape.cpp, src/livarot/Shape.h,
	src/livarot/ShapeMisc.cpp, src/livarot/ShapeSweep.cpp: move some
	functions out of Shape that don't need to be members.

	* src/livarot/Shape.h: reduce public: and private: sections to
	just one of each.  Coding style cleanups.  No code changes.

	* src/livarot/Shape.h: remove some unused code; const fixes.

2004-09-10  Carl Hetherington <inkscape@carlh.net>

	* src/livarot/Shape.cpp, src/livarot/Shape.h,
	src/livarot/ShapeDraw.cpp, src/livarot/ShapeMisc.cpp,
	src/livarot/ShapeRaster.cpp, src/livarot/ShapeSweep.cpp: excise
	Shape::nbPt.

	* src/sp-offset.cpp, src/splivarot.cpp,
	src/display/nr-arena-shape.cpp, src/livarot/Shape.h: Make
	Shape::aretes private and offer a read-only accessor.

	* src/livarot/Shape.cpp, src/livarot/Shape.h,
	src/livarot/ShapeDraw.cpp, src/livarot/ShapeMisc.cpp,
	src/livarot/ShapeRaster.cpp, src/livarot/ShapeSweep.cpp,
	src/livarot/ShapeSweepUtils.cpp: use getEdge() more and excise
	Shape::nbAr.

	* src/livarot/Shape.cpp, src/livarot/Shape.h,
	src/livarot/ShapeMisc.cpp, src/livarot/ShapeRaster.cpp,
	src/livarot/ShapeSweep.cpp, src/livarot/ShapeSweepUtils.cpp: use
	std::vector for most of the temporary arrays in Shape.

2004-09-11  MenTaLguY <mental@rydia.net>

	* src/render/bezier.cpp, src/render/bezier.h,
	  src/render/shape-builder.cpp, src/render/shape-builder.h,
	  src/render/stroke.cpp, src/render/stroke.h:

	  further work on stroking; break out bezier approximation into
	  public functions

2004-09-10  MenTaLguY <mental@rydia.net>

	* src/render/polygon.h, src/render/shape-builder.h,
	  src/render/shape-builder.cpp, src/render/stroke.h,
	  src/render/dash.h:

	  beginnings of a simple alternate renderer

2004-09-09  Carl Hetherington <inkscape@carlh.net>

	* src/sp-flowtext.cpp, src/sp-offset.cpp, src/splivarot.cpp,
	src/display/nr-arena-shape.cpp, src/libnrtype/FlowDest.cpp,
	src/livarot/PathConversion.cpp, src/livarot/Shape.h: make
	Shape::nbPt and Shape::nbAr private and provide accessor methods.

	* src/display/nr-arena-shape.cpp, src/livarot/Shape.h: make
	Shape::flags private.

	* src/splivarot.cpp, src/livarot/PathStroke.cpp,
	src/livarot/Shape.cpp, src/livarot/Shape.h, src/livarot/ShapeMisc.cpp,
	src/livarot/ShapeRaster.cpp, src/livarot/ShapeSweep.cpp:
	Clean up handling of flags in Shape class

	* src/livarot/AlphaLigne.cpp, src/livarot/Path.cpp,
	src/livarot/PathSimplify.cpp, src/livarot/Shape.cpp,
	src/livarot/ShapeSweepUtils.cpp: it's ok to free NULL.

	* src/livarot/Shape.h, src/sp-offset.cpp, src/splivarot.cpp,
	src/display/nr-arena-shape.cpp: Make Shape::pts private and offer
	a read-only accessor.

	* src/livarot/Shape.cpp, src/livarot/Shape.h,
	src/livarot/ShapeDraw.cpp, src/livarot/ShapeMisc.cpp,
	src/livarot/ShapeRaster.cpp, src/livarot/ShapeSweep.cpp, src/
	livarot/ShapeSweepUtils.cpp, src/livarot/ShapeUtils.h: Rename
	Shape::pts to Shape::_pts, and use getPoint() wherever possible.

	* src/sp-offset.cpp, src/splivarot.cpp, src/livarot/Shape.cpp,
	src/livarot/Shape.h, src/livarot/ShapeMisc.cpp,
	src/livarot/ShapeRaster.cpp, src/livarot/ShapeSweep.cpp: Add
	dg_point::totalDegree() and make use of it.


2004-09-08  MenTaLguY  <mental@rydia.net>

	* src/libnr/nr-object.h, src/libnr/nr-object.cpp: fix NRObject
	  initialization

	* configure.in, src/gc-core.h, src/gc-managed.h, src/gc-anchored,
	  src/gc-finalized.h:

	  add a --disable-gc ./configure option to omit garbage collection
	  from the build (the normal allocator will be used, although
	  memory will obviously leak since it does not get explicitly freed)

	* src/xml/repr.cpp: SPRepr's copy constructor needs to properly
	  initialize its fields

	* src/xml/repr-util.cpp, src/xml/repr-private.h,
	  src/xml/repr.h, src/xml/repr.cpp:

	  new child-count-related routines, and added mutation signals
	  to SPReprDoc

	* src/desktop.cpp: call the "Active Group" widget by its TRUE NAME!

	* src/widgets/Makefile_insert, src/widgets/document-tree-model.cpp,
	  src/widgets/document-tree-model.h, src/widgets/layer-selector.cpp,
	  src/widgets/layer-selector.h:

	  very cursory start on new layers UI

2004-09-08  Carl Hetherington <inkscape@carlh.net>

	* src/helper/stock-items.cpp: fix a bad free().  Improve coding
	style compliance.

	* src/libnrtype/FlowRes.cpp: slightly unpleasant fix for a buffer
	overrun.

2004-09-07  MenTaLguY <mental@rydia.net>

	* src/livarot/Shape.cpp, src/livarot/Shape.h, src/livarot/ShapeMisc.cpp,
	  src/livarot/ShapeSweep.cpp:

	  use std::vector for points array (seems to crash less?)

	* src/livarot/AlphaLigne.cpp, src/livarot/BitLigne.cpp,
	  src/livarot/Ligne.cpp, src/livarot/Path.cpp,
	  src/livarot/PathCutting.cpp, src/livarot/PathSimplify.cpp,
	  src/livarot/Shape.cpp, src/livarot/ShapeMisc.cpp,
	  src/livarot/ShapeSweep.cpp, src/livarot/ShapeSweepUtils.cpp:

	  switch to glib's allocator routines, which have the expected
	  semantics

	* src/livarot/evil-malloc.h: removed

2004-09-07  Ted Gould  <ted@gould.cx>

	* src/color-rgba.h:

	Some comments and some little code clean up things.  Added a couple
	of constructors to make life a little simpler.

2004-09-06  Ted Gould  <ted@gould.cx>
	* src/extension/plugin/gimgrad.cpp, src/extension/implementation/plugin*
	  share/extension/gimpgrad.inkmod, src/extension/system.cpp,
	  src/extension/extension.h:

	Mega commit.  This commit does two things, it adds in the ability to
	do plugins in Inkscape.  This means that there are loadable modules
	that can be used for just about anything.  It also provides a sample
	implementation of a plugin to load GIMP gradients.  This means that
	GIMP gradients can be imported into Inkscape, giving a larger set of
	gradients that can be used in Inkscape.

	Currently, nothing here is really complete, but it is functional.  The
	plugins really only work for input plugins, and the GIMP gradient example
	isn't very robust.  They will come shortly.

2004-09-05  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/display/curve.h, src/display/curve.cpp:
	  Change x,y members to NR::Point.
	  Rename posset (spiced&spiked hot milk) to posSet as per CodingStyle.

	* src/display/curve.cpp (sp_curve_reverse): Previously this
	  routine returned only the last subpath, and made it an open
	  path.  Now it preserves all aspects of the curve other than
	  reversing it.  I believe this change makes no difference to the
	  draw-context and dyna-draw-context callers (though I haven't
	  managed to test all of these callers), whereas for the `reverse
	  path' command, users presumably expect the new behaviour.

	* src/display/curve.cpp (sp_curve_closepath_current):
	  Fix bad assertion.

	* src/libnr/nr-matrix-fns.h, src/libnr/nr-matrix-fns.cpp
	  (get_translation): New function.

	* src/sp-polygon.cpp (polygon_get_value): Use static linkage.
	  (sp_polygon_set): Remove debugging output.  Add `todo' comment.

2004-09-03  MenTaLguY <mental@rydia.net>

	* src/attributes.cpp, src/attributes.h, src/sp-namedview.cpp,
	  src/sp-namedview.h:

	  remember previously selected layer on load

2004-09-02  MenTaLguY <mental@rydia.net>

	* src/attributes.cpp, src/attributes.h, src/sp-item-group.cpp:

	  reintroduced the inkscape:groupmode attribute

	* src/gc-core.h, src/gc-finalized.h, src/gc-anchored.h,
	  src/libnr/nr-object.cpp:

	  remove USE_LIBGC macro again

2004-08-30  MenTaLguY <mental@rydia.net>

	* src/sp-object.cpp:

	  ref the object while SPObject::deleteObject runs, so it doesn't
	  get destroyed halfway through [ fix for bug #1012874 ]

2004-08-29  MenTaLguY <mental@rydia.net>

	* src/gc-core.h:
	
	  turn off scanning of dynamic library data segments; we don't need
	  it, and it seems to cause problems on FC2

2004-08-27  MenTaLguY <mental@rydia.net>

	* src/traits/function.h: add typedefs for all argument positions,
	  specifying 'void' for all arguments after the last

	* src/livarot/evil-malloc.h, src/livarot/BitLigne.cpp,
	  src/livarot/PathCutting.cpp, src/livarot/PathSimplify.cpp,
	  src/livarot/Shape.cpp, src/livarot/ShapeSweepUtils.cpp:

	  work around livarot bugs so I can use ElectricFence

	* src/gc-core.h, src/gc-finalized.h, src/gc-anchored.h,
	  src/libnr/nr-object.cpp:

	  make the garbage collector easy to disable by undefining
	  USE_LIBGC in src/gc-core.h

2004-08-26  MenTaLguY <mental@rydia.net>

	* src/document-private.h, src/document.h, src/document.cpp:

	  add notification signal when resources are added or removed

2004-08-25  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/xml/repr-css.cpp (sp_repr_css_print):
	  Fix for shared string change.

	* src/sp-text.cpp (sp_text_description):
	  Fix for when font Name() call fails.

	* src/sp-text.cpp: CodingStyle changes, including moving some
	  declarations to first use.
	  Remove unused __SP_TEXT_C__ define.

2004-08-25  Carl Hetherington  <inkscape@carlh.net>

	* src/sp-cursor.cpp, src/sp-cursor.h, src/sp-guide.cpp:
	coding style cleanups.

2004-08-24  MenTaLguY <mental@rydia.net>

	* src/gc-anchor.h: fix to always use the GC base address, since
	  that will not always be the same as 'this', when I::GC::Anchored
	  is used via multiple inheritance.

2004-08-24  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/libnrtype/TextWrapper.h, src/libnrtype/TextWrapper.cpp (AppendUTF8):
	  Use strlen instead of for-loop.
	  Change printf to g_return_if_fail (and document that the argument
	  must be valid UTF-8).
	  Mark the text pointer as not being written through (const).

2004-08-23  MenTaLguY <mental@rydia.net>

	* src/xml/repr.cpp, src/xml/sp-repr-action.h:

	  removed stupid default 'next' constructor arguments and force them
	  to be specified explicitly (and fix the omission of one, which
	  fixes bug #1014541)

2004-08-22  MenTaLguY <mental@rydia.net>

	* src/Makefile_insert, src/gc-alloc.h:

	  introduced a GC-aware STL allocator

	* src/document-private.h, src/document.h, src/document.cpp:

	  switch to using STL map for "id changed" signals

2004-08-21  MenTaLguY <mental@rydia.net>

	* src/Makefile_insert, src/util/Makefile_insert: get libinkutil
	  deps straightened out

	* src/document-private.h, src/document-undo.cpp, src/document.cpp:

	  adapt for new APIs, header cleanups/refactorings

	* src/gc-core.h, src/gc-anchored.h, src/gc-finalized.h, src/gc-managed.h:

	  rewrote interface to Boehm GC for increased flexibility; there are now
	  three main classes:

	   - Inkscape::GC::Managed: objects managed by the GC; replaces
	                            Inkscape::GC::Object

	   - Inkscape::GC::Finalized: objects for which the GC will call
	                              destructors automatically; replaces
	                              Inkscape::GC::FinalizedObject

	   - Inkscape::GC::Anchored: managed objects which can be 'anchored'
	                             to prevent collection while non-gc-aware
	                             objects are holding references; replaces
	                             Inkscape::Refcounted

	  Note that they no longer inherit from each other(!), so you will
	  need to mix-and-match via multiple inheritance.  The latter two
	  don't do anything useful without the first, however.

	* src/gc-object.h, src/refcounted.h: removed

	* src/message-context.cpp, src/message-stack.h, src/selection.h,
	  src/view.cpp, src/libnr/nr-object.h, src/util/list.h,
	  src/xml/sp-repr-attr.h, src/xml/sp-repr-listener.h, src/desktop.cpp:

	  adopt new GC API and header refatorings

	* src/Makefile.am, src/util/Makefile_insert:
	
	  list util/* files in util's Makefile_insert now.

	* src/util/reverse.h: revive anx fix Inkscape::Util::reverse

	* src/util/share-c-string.cpp, src/util/share-c-string.h: removed

	* src/util/shared-c-string.cpp, src/util/shared-c-string.h:

	  employ the type system to make shared strings a little safer to use;
	  you can still shoot yourself in the foot, but at least now you need
	  to aim and pull the trigger first

	* src/xml/Makefile_insert, src/xml/repr-action-test.cpp,
	  src/xml/sp-repr-action-fns.h, src/xml/sp-repr-action.h:

	  reorganize transaction logging files

	* src/xml/repr-action-test.cpp: updated headers

	* src/xml/repr-action.cpp, src/xml/repr-action.h: removed

	* src/xml/repr-private.h, src/xml/repr.cpp, src/xml/repr.h:

	  update for new GC API and shared strings

	* src/xml/sp-repr-action-fns.h, src/xml/sp-repr-action.cpp,
	  src/xml/sp-repr-action.h:

	  header refactoring and new GC API

	* src/xml/sp-repr-attr.h, src/xml/sp-repr-listener.h:

	  new GC API

2004-08-20  Carl Hetherington <inkscape@carlh.net>

	* src/zoom-context.cpp, src/view.cpp, src/version.cpp,
	src/sp-defs.cpp: coding style cleanups.

	* src/sp-polygon.cpp: coding style and a few other small cleanups.

	* src/sp-anchor.cpp: coding style cleanups.  Remove unnecessary
	static variable.

2004-08-18  Bryce Harrington <bryce@bryceharrington.org>

	* autogen.sh:  Fixing the 'missing ltmain.sh' bug

2004-08-17  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-star.cpp: Use cast to guint32 instead of using modulo 2**32.
	  Fix a uint compilation bug on Windows reported by mrchapp.
	  Mark a few functions as static.

2004-08-16  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-conn-end.cpp (change_endpts):
	  Use new sp_curve_stretch_endpoints function: i.e. preserve the
	  shape of the connector path.

	* src/display/curve.h, src/display/curve.cpp
	  (sp_curve_stretch_endpoints): New function.

	* src/sp-use-reference.cpp: CodingStyle changes.

	* src/sp-item.h, src/sp-item.cpp (sp_item_write_transform):
	  Indicate that adv won't get written to.

	* src/sp-rect.cpp (sp_rect_set_transform): Call sp_rect_set_shape,
	  so that bbox is up-to-date.

2004-08-15  Carl Hetherington  <inkscape@carlh.net>

	* src/object-edit.cpp: fix a regression in my cleanups from yesterday.

2004-08-15  MenTaLguY  <mental@rydia.net>

	* src/Makefile.am, src/Makefile_insert, src/util/Makefile_insert:

	  added libinkutil for util/ directory

	* src/arc-context.cpp, src/desktop.cpp, src/event-context.cpp,
	  src/node-context.cpp, src/rect-context.cpp, src/sp-object.cpp,
	  src/sp-text.cpp, src/spiral-context.cpp, src/star-context.cpp,
	  src/toolbox.cpp, src/dialogs/desktop-properties.cpp,
	  src/widgets/gradient-vector.cpp, src/widgets/sp-widget.cpp,
	  src/widgets/sp-xmlview-attr-list.cpp,
	  src/widgets/sp-xmlview-content.cpp, src/widgets/sp-xmlview-tree.cpp,
	  src/xml/sp-repr-event-vector.h, src/xml/sp-repr-listener.h:

	  moved SPReprListener and SPReprEventVector into their own header
	  files, and remove "destroy" callback

	* src/util/share-c-string.cpp, src/util/share-c-string.h:

	  add Inksape::Util::share_c_string, a function to make an
	  immutable and garbage-collected copy of a string which can
	  safely be shared
	
	* src/xml/Makefile_insert, src/xml/repr-action.cpp, src/xml/repr-css.cpp,
	  src/xml/repr-private.h, src/xml/repr.cpp, src/xml/sp-repr-attr.h:

	  start sharing rather than copying strings, and taking advantage
	  of garbage collection

2004-08-15  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-flowtext.cpp: CodingStyle changes.

2004-08-14  Carl Hetherington  <inkscape@carlh.net>

	* src/sp-use-reference.cpp, src/sp-use-reference.h: use sigc 2.0
	API rather than the old one.

	* src/spiral-context.cpp: Use new message API.  Some
	declaration-to-first-use and const fixes.

	* src/star-context.cpp: Use new message API.  Remove the unused
	sp_star_context_item_handler().

	* src/spiral-context.h, src/star-context.h: Inherit
	from SPEventContext to get access to the new message API.

	* src/streams-zlib.cpp: fix a compiler warning.

	* src/extension/internal/gdkpixbuf-input.cpp: Fix a compiler
	warning and a memory leak.  Minor cleanups.

	* src/libnrtype/FlowRes.cpp, src/libnrtype/FlowResOut.cpp,
	src/libnrtype/FlowSrc.cpp: fix some compiler warnings.

	* src/inkjar/jar.cpp: fixed a compiler warning and added a FIXME.

	* src/object-edit.cpp: make use of sp_pattern_extract_trans.

2004-08-14  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-rect.cpp (sp_rect_set_shape): Change rounded-rect
	  behaviour to be closer to [opinion on www-svg as to the
	  interpretation of] the SVG 1.1 specification.

2004-08-13  MenTaLguY  <mental@rydia.net>

	* src/xml/repr-action.h, src/xml/repr-action.cpp:

	  simplified code now that we can take advantage of garbage collection

2004-08-13  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/dialogs/xml-tree.cpp (set_dt_select):
	  Address warning introduced in r1.21.
	  Minor other cleanups.

2004-08-12  MenTaLguY  <mental@rydia.net>

	* src/xml/repr-css.cpp, src/xml/repr-private.h,
	  src/xml/repr.cpp, src/xml/repr.h:

	  make SPRepr gc-aware

2004-08-12  Carl Hetherington  <inkscape@carlh.net>

	* src/sp-chars.cpp src/sp-ellipse.cpp src/sp-flowtext.cpp
	src/sp-image.cpp src/sp-item-group.cpp src/sp-item.cpp
	src/sp-item.h src/sp-marker.cpp src/sp-offset.cpp src/sp-root.cpp
	src/sp-shape.cpp src/sp-spiral.cpp src/sp-star.cpp
	src/sp-symbol.cpp src/sp-text.cpp src/sp-use.cpp:
	const fixes to snappoints and bbox methods

	*  selection.cpp sp-ellipse.cpp sp-image.cpp sp-item-group.cpp
	sp-item-notify-moveto.cpp sp-item-rm-unsatisfied-cns.cpp
	sp-item-update-cns.cpp sp-item.cpp sp-item.h sp-offset.cpp
	sp-shape.cpp sp-spiral.cpp sp-star.cpp sp-text.cpp:
	use more efficient API for collecting snap points, suggested by Peter.

	* src/dialogs/desktop-properties.cpp: fix a cast warning.

	* src/dialogs/docker.cpp: fix an unused variable warning.

	* src/dialogs/stroke-style.cpp: add a static qualifier to a function.
	
2004-08-12  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-flowregion.cpp, src/sp-flowtext.cpp, src/sp-offset.cpp,
	src/splivarot.cpp, src/display/nr-arena-shape.cpp,
	src/livarot/PathConversion.cpp, src/livarot/Shape.cpp,
	src/livarot/Shape.h, src/livarot/ShapeDraw.cpp, src/livarot/ShapeMisc.cpp,
	src/livarot/ShapeRaster.cpp, src/livarot/ShapeSweep.cpp,
	src/livarot/ShapeSweepUtils.cpp:
	  Revert these files to their state prior to mental's "2004-08-08"
	  entry (the change made in 2004-08-09 02:23 UTC).

2004-08-11  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/algorithms/longest-common-suffix.h: Fix bug I introduced three
	  days ago.

	* src/attributes.h, src/attributes.cpp: New attributes
	  SP_ATTR_CONNECTION_START, SP_ATTR_CONNECTION_END.
	* src/sp-conn-end.h, src/sp-conn-end.cpp,
	  src/sp-conn-end-pair.h, src/sp-conn-end-pair.cpp:
	  New files.
	* src/Makefile_insert (libinkpre_a_SOURCES): Add the new files.

	* src/sp-path.cpp, src/sp-path.h: Call the new connector stuff.

	* src/display/curve.h, src/display/curve.cpp
	  (sp_curve_first_point, sp_curve_last_point): New functions.

	  (sp_curve_transform): Re-implement with NR::Matrix/NR::Point.
	  The old code appears to be buggy for sheer/rotate matrices
	  due to calculating each y coord using the new corresponding x coord
	  instead of the previous value.

	  Also add NR::translate version.

	  Get rid of the return value.  Callers updated.

	* src/sp-item.h, src/sp-item.cpp: (i2anc_affine): New function
	  (essentially a rename of existing private partial_xform function, but
	  differing behaviour on encountering non-SPItem in the hierarchy).

	  (i2i_affine): New function (essentially a rename of existing
	  SPItem::getRelativeAffine).  Implement SPItem::getRelativeAffine in
	  terms of the new function.

	  (sp_item_dt2i_affine): NR::Matrix version.

	* src/libnr/nr-path.h (c, setC): new methods.

2004-08-09  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/desktop-affine.cpp (sp_desktop_w2doc_affine,
	sp_desktop_doc2w_affine, sp_desktop_doc2d_xy_point),
	src/knotholder.cpp (knot_moved_handler), src/sp-item.cpp
	(SPItem::getRelativeTransform), src/sp-rect.cpp
	(sp_rect_set_transform), src/display/sp-canvas-util.cpp
	(sp_canvas_item_i2i_affine, sp_canvas_item_set_i2w_affine):
	  Cleanup: Use the new division operators instead of multiplication by
	  inverse.  (Currently the division operators are implemented as
	  multiplication by inverse.)

	* src/splivarot.cpp, src/livarot/Shape.cpp, src/livarot/ShapeMisc.cpp,
	src/livarot/ShapeRaster.cpp, src/livarot/ShapeSweep.cpp:
	  Hurriedly fix some problems caused by overly-hurried changes.
	  Address some signed/unsigned warnings.
	  Add some assertions.
	  (Haven't checked the performance cost of the assertions.)

	* src/livarot/Shape.h: Make constructors explicit.

2004-08-08  MenTaLguY  <mental@rydia.net>

	* src/sp-flowregion.cpp, src/sp-flowtext.cpp, src/sp-offset.cpp,
	  src/splivarot.cpp, src/display/nr-arena-shape.cpp,
	  src/livarot/PathConversion.cpp, src/livarot/Shape.cpp,
	  src/livarot/Shape.h, src/livarot/ShapeDraw.cpp,
	  src/livarot/ShapeMisc.cpp, src/livarot/ShapeRaster.cpp,
	  src/livarot/ShapeSweep.cpp, src/livarot/ShapeSweepUtils.cpp:

	  replace ad-hoc realloced arrays with std::vector and deal with
	  uninitialized data problems that valgrind complained about

	* libgc.supp: valgrind suppression profile for libgc, which necessarily
	  reads and runs comparisons on a lot of uninitalized data; the present
	  form of this file is probably too broad however

2004-08-08  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/libnr/nr-matrix-div.h, src/libnr/nr-matrix-div.cpp:
	  operator/(NR::Point, NR::Matrix), operator/(NR::Matrix, NR::Matrix):
	  new functions, new files.

	* src/algorithms/longest-common-suffix.h:
	  Handle in O(1) time the common case of equal tails.
	  Documentation.

2004-08-08  Ted Gould  <ted@gould.cx>

	* src/svg-profile.h, src/Makefile_insert:

	Adding the first support in for trying to determine which profiles are
	used with certain functionality, and if that is used by the current
	document.  Really, right now, there is no code changes to anything that
	compiles.  But this is the header file that contains the class that
	I'm plannig to use in the future.

2004-08-07  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/libnrtype/RasterFont.h, src/libnrtype/RasterFont.cpp:
	  Get rid of argumentless constructor (which was leaving
	  style.transform as random bits), replace with constructor taking
	  style argument.  Caller updated.
	  Disable default copy constructor and operator=.

2004-08-06  MenTaLguY <mental@rydia.net>

	* configure.in, src/gc-core.h, src/gc-object.h,
	  src/display/nr-arena-glyphs.cpp, src/display/nr-arena-group.cpp,
	  src/display/nr-arena-image.cpp, src/display/nr-arena-item.cpp,
	  src/display/nr-arena-shape.cpp, src/display/nr-arena.cpp,
	  src/helper/action.cpp, src/libnr/nr-object.cpp, src/libnr/nr-object.h:

	  make NRObject GC-aware

2004-08-06  David Turner <novalis@gnu.org
	* src/sp-shape.cpp (sp_shape_marker_get_transform): Make marker handling match
	SVG spec better.

2004-08-06  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/libnr/nr-matrix.h, src/libnr/nr-matrix.cpp:
	  NR::Matrix *= NR::scale: new.

	* src/sp-object.cpp, src/sp-object.h, src/sp-object-tree-iterator.h:
	  Move TreeIterator<SPObject *> specialization to snew file
	  sp-object-tree-iterator.h.
	  Mark several pointers as not being written through.
	  Correspondingly change TreeIterator specialization to
	  <SPObject const *> instead of <SPObject *>.

	* display/nr-arena-item.cpp, display/nr-arena-item.h:
	  Add NR::Matrix version of nr_arena_item_set_transform.

	* src/sp-item.h, src/sp-item.cpp (getRelativeTransform, partial_xform):
	  Mark pointers as not written through.

	* src/arc-context.cpp, src/draw-context.cpp, src/dyna-draw-context.cpp,
	  src/path-chemistry.cpp, src/rect-context.cpp,
	  src/selection-chemistry.cpp, src/seltrans.cpp, src/sp-flowdiv.cpp,
	  src/sp-flowregion.cpp, src/sp-flowtext.cpp, src/sp-item-group.cpp,
	  src/sp-item-notify-moveto.cpp, src/sp-item-transform.cpp,
	  src/sp-item.cpp, src/sp-item.h, src/sp-offset.cpp, src/sp-rect.cpp,
	  src/sp-shape.cpp, src/sp-use.cpp, src/spiral-context.cpp,
	  src/splivarot.cpp, src/star-context.cpp, src/text-context.cpp,
	  src/dialogs/item-properties.cpp:
	  Change SPItem->transform from NRMatrix to NR::Matrix.

	* src/libnr/nr-matrix-ops.h (operator*(NR::Matrix, NRMatrix)): new.

	* src/libnr/nr-matrix.h: NR::Matrix *= NR::translate: new operator.

	* src/nodepath.cpp: Mark NodeSort operator< as static.
	  Indentation as per CodingStyle.

	* src/libnr/nr-scale.h (NR::scale(double)): new constructor.

	* src/svg/svg-affine.cpp (sp_svg_transform_write), src/svg/svg.h:
	  Add NR::Matrix version.

2004-08-05  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/display/bezier-utils.cpp: Misc. minor changes.

2004-08-04  MenTaLguY  <mental@rydia.net>

	* configure.in, src/gc-object.h, src/refcounted.h:

	  start using libgc in earnest; Inkscape::Refcounted is now GC-aware

2004-08-04  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/nodepath.cpp: Cleanups: Mark some things as static.  Switch from
	  pointer to reference in some places. Make const placement conform to
	  CodingStyle.

	* src/inkview.cpp (sp_svgview_main_key_press): Accept some common keys
	  like PgUp, q.

	* src/draw-context.cpp (fit_and_split):
	  Slight simplification: don't handle impossible condition npoints < 2.
	* src/proofs: Update accordingly.  (Also add some bezier-utils proofs.)

2004-08-04  David Turner <novalis@gnu.org>

	* sp-path.cpp: 'd' is a required attribute for paths.  Ensure that
	all paths have it.

2004-08-03  MenTaLguY  <mental@rydia.net>

	* src/dialogs/rdf.cpp, src/xml/repr-util.cpp, src/xml/repr.h:
	  removed sp_repr_recursive_drop() which is unneeded and
	  creates unnecessary thrash in the undo logs

	* src/livarot/Shape.h, src/livarot/Shape.cpp,
	  src/livarot/ShapeSweep.cpp, src/livarot/ShapeMisc.cpp:

	  experiment to replace ad-hoc realloc() arrays with std::vector

2004-08-02  David Turner <novalis@gnu.org>

	* file.cpp, file.h, interface.cpp, toolbox.cpp, verbs.cpp, verbs.h:

	Added vacuum command to remove unused defs.

2004-08-02  MenTaLguY  <mental@rydia.net>

	* configure.in: sigc++ 2.0.2 (and before?) has a bug that
	  causes us to crash.  require >= 2.0.3

	* src/Makefile.am, src/Makefile_insert, src/gc-core.h,
	  src/gc-object.h, src/algorithms/longest-common-suffix.h,
	  src/traits/list.h, src/traits/reference.h, src/util/flip.h,
	  src/util/fold.h, src/util/list-iterator.h, src/util/list.h,
	  src/util/map.h, src/util/parent-axis.h, src/util/reverse.h,
	  src/util/sibling-axis.h, src/util/tuple.h, src/util/zip.h:

	  more "functional" work

2004-08-02  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/display/curve.cpp, src/display/curve.h:
	  Greater conformance with CodingStyle.

2004-07-31  David Turner <novalis@gnu.org>

	* dialogs/xml-tree.cpp: Improved focus, added keystroke for attr commit.

2004-07-31  Ted Gould  <ted@gould.cx>

	* src/extension/extension.cpp,
	src/extension/implementation/implementation.cpp,
	src/extension/implementation/implementation.h,
	src/extension/implementation/script.cpp,
	src/extension/implementation/script.h, src/extension/internal/eps-out.cpp,
	src/extension/internal/eps-out.h:

	Okay, changed the prefs_ prototypes to include which extension they are
	working with. This should clean up some warnings before they become
	problems later.

2004-07-31  Ted Gould  <ted@gould.cx>

	* src/print.cpp, src/extension/extension.cpp, src/extension/extension.h,
	  src/extension/internal/eps-out.cpp, src/extension/internal/ps.cpp:

	  Changed the get and set param prototypes so that they aren't overloaded
	  anymore - this was flaky.  Also added a document to the prototype so
	  that document specific parameters can be supported in the future.

2004-07-28  David Turner <novalis@gnu.org>

	* sp-gradient.cpp, widgets/gradient-vector.cpp: fixed gradient handling to
	properly render gradients with sharp color boundaries

2004-07-29  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/inkview.cpp: Make the window title be the name of the
	  instead of the current file instead of the first file.

	* src/round-test.cpp: New unit-test file.

	* src/desktop.h, src/sp-desktop-widget.h:
	  Move SPDesktopWidget stuff from desktop.h to new file
	  sp-desktop-widget.h.

	* debian/*: Copy lots of changes from wolfi's official Debian package
	  of inkscape.
	  Also use separate builddir, which simplifies the `clean' target.

2004-07-24  MenTaLguY  <mental@rydia.net>

	* configure.in, src/Makefile.am, src/main.cpp, src/gc-core.h:
	  added libgc dependency

	* src/Makefile.am, traits/function.h:
	  added trait class for functions and C++ "functors"

	* src/Makefile.am, util/flip.h:
	  added flip() which, given a function with two arguments,
	  returns an identical function with its arguments reversed

2004-07-23  MenTaLguY  <mental@rydia.net>

	* src/Makefile.am, src/traits/reference.h, src/util/tuple.h:
	  added generic Tuple type

2004-07-23  Ted Gould  <ted@gould.cx>

	* src/attributes.cpp, src/attributes.h, src/sp-namedview.cpp,
	src/sp-namedview.h, src/dialogs/desktop-properties.cpp,
	src/display/canvas-grid.cpp, src/display/canvas-grid.h:

	Adding in the ability to have 'emphasis grid lines' where some lines are a
	different color than others.  In the default case every fifth grid line
	gets to be 0x11 darker alpha.  Nothing that will get in your way, but
	enough that you can find the spacing.  All parameters are changeable in
	document preferences.

2004-07-23  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* autogen.sh: Move unversioned automake to last resort.

2004-07-20  Kees Cook  <kees@outflux.net>

	* src/dialogs/desktop-preferences.cpp: corrected my usage of static
	  l18n strings.
	* src/dialogs/stroke-style.cpp: fixed missing l18n. (bug #994837)
	* src/dialogs/sp-attribute-widget.cpp: went hunting for other static
	  l18n strings.  Fixed some here too.
	* autogen.sh: cleanups and more debugging.
	* share/extensions/sk2svg.sh: tempfile cleanups from pjrm (patch #990009)

2004-07-20 Nathan Hurst <njh@mail.csse.monash.edu.au>

	* debian/changelog, configure.in: Moved to 0.40cvs and updated
	  debian stuff.
	
2004-07-18  MenTaLguY  <mental@rydia.net>

	* configure.in, src/Makefile.am, src/algorithms/Makefile_insert,
	  src/algorithms/makefile.in, src/traits/Makefile_insert,
	  src/traits/makefile.in, src/util/Makefile_insert, src/util/makefile.in:

	  added src/algorithms, src/traits, and src/util subdirs
	
	* src/algorithms/longest-common-suffix.h:

	  added generic "longest common suffix" algorithm

	* src/traits/list.h: added traits class for lists

	* src/traits/tree-iterator.h: added traits class for n-ary tree iterators

	* src/util/list-iterator.h: STL iterator for lists

	* src/util/parent-axis.h: parent "axis" of tree iterator as list

	* src/util/sibling-axis.h: sibling "axis" of tree iterator as list

	* src/xml/repr.h: specialize Traits::TreeIterator for SPRepr *

	* src/sp-object.h: specialize Traits::TreeIterator for SPObject *
	
	* src/sp-object.cpp: use generic "longest common suffix" to find
	                     nearest common ancestor
	
	* src/splivarot.cpp: use genric "longest common suffix" to find
	                     nearest common ancestor here too

2004-07-18  Kees Cook  <kees@outflux.net>

	* Makefile.am, configure.in, autogen.sh, toolversions.sh:
	  cleaning up some automake misbehavior from the gtkmm patch.
	  automake 1.4isms snuck back in.
	* src/desktop-events.cpp: unlocalized strings updated.

2004-07-18  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-path.cpp (sp_path_write): Handle shape->curve==NULL.

2004-07-18  MenTaLguY  <mental@rydia.net>

	* Makefile.am, configure.in, m4/Makefile.am, m4/codeset.m4, m4/gettext.m4,
	  m4/glibc21.m4, m4/iconv.m4, m4/isc-posix.m4, m4/lcmessage.m4,
	  m4/progtest.m4, src/arc-context.cpp, src/arc-context.h, src/desktop.cpp,
	  src/desktop.h, src/document.cpp, src/document.h, src/draw-context.cpp,
	  src/draw-context.h, src/event-context.h, src/main.cpp,
	  src/message-stack.h, src/node-context.cpp, src/node-context.h,
	  src/nodepath.cpp, src/nodepath.h, src/object-hierarchy.h,
	  src/rect-context.cpp, src/rect-context.h, src/selcue.cpp, src/selcue.h,
	  src/selection-describer.cpp, src/selection-describer.h,
	  src/selection.h, src/seltrans.cpp, src/sp-gradient.cpp,
	  src/sp-item.cpp, src/sp-item.h, src/sp-object.cpp, src/sp-object.h,
	  src/sp-offset.cpp, src/sp-offset.h, src/sp-pattern.cpp, src/sp-use.cpp,
	  src/sp-use.h, src/spiral-context.cpp, src/spiral-context.h,
	  src/star-context.cpp, src/star-context.h, src/text-context.cpp,
	  src/text-context.h, src/toolbox.cpp, src/uri-references.cpp,
	  src/uri-references.h, src/view.cpp, src/view.h,
	  src/dialogs/xml-tree.cpp:

	  merged Aubanel MONNIER's gtkmm upgrade patch

2004-07-17  Carl Hetherington  <inkscape@carlh.net>

	* src/sp-use.cpp: fix a compiler warning (closes #992960)

	* src/sp-offset.cpp: fix a compiler warning (closes #992960)

	* src/sp-text.cpp: fix a compiler warning (closes #992959)

2004-07-16  Kees Cook  <kees@outflux.net>

	* src/verbs.h, src/verbs.cpp: added "sp_verbs_find" function for bryce.

2004-07-15  Ted Gould  <ted@gould.cx>

	* 0.39 Release

2004-07-14  MenTaLguY  <mental@rydia.net>

	* src/sp-object.cpp: disable recursive update warning for release

	* src/select-context.cpp: work around probable cut-and-paste bug
	  between sp_select_context_item_handler and
	  sp_select_context_root_handler by checking for drag_escaped

2004-07-13  MenTaLguY  <mental@rydia.net>

	* src/make.exclude: omit extension/script/js/js.c from build

2004-07-13  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/dialogs/rdf.cpp: Don't add dc:description entry to SVG files.

	* src/utest/utest.h: Add include guard.

2004-07-12  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/decimal-round.h (decimal_round): New file, new function.
	* src/round.h (decimal_round): New file, new function.
	* src/Makefile_insert: Add to libinkpost_a_SOURCES.

2004-07-11  MenTaLguY  <mental@rydia.net>

	* src/document.h, src/document-undo.cpp:
	  added sp_document_get_undo_sensitive() for capturing and restoring
	  undo sensitivity

	* src/sp-object.cpp: don't log id changes made to resolve
	  duplicate ids (to avoid undo badness) (fix for bug #989023)

2004-07-11  Kees Cook  <kees@outflux.net>

	* src/preferences-skeleton.h, src/extension/init.cpp: with simarilius,
	  tracked down the cause of bug #988445.  Extension code now has a
	  small section that validates preferences for valid extension names.
	* src/dialogs/filedialog-win32.cpp: corrected an assert test, and
	  changed dialog to take the passed window title.
	* autogen.sh, config.h.mingw, configure.in, src/Makefile_insert,
	  src/help.cpp, src/inkscape-stock.cpp, src/inkscape.cpp, src/main.cpp,
	  src/make.dep, src/make.files, src/path-prefix.h, src/prefix.cpp,
	  src/prefix.h, src/dialogs/stroke-style.cpp,
	  src/extension/Makefile_insert, src/extension/init.cpp,
	  src/extension/implementation/Makefile_insert,
	  src/extension/implementation/script.cpp,
	  src/extension/internal/Makefile_insert, src/helper/stock-items.cpp,
	  src/widgets/icon.cpp:
	Cleaned up all the path #define's and usage.  In the process found at
	least 3 separate bugs associated with file locations.  This should
	hopefully work for Win32 as well.  Bottom line in this change: don't use
	INKSCAPE_DATADIR anywhere except in "path-prefix.h".  This includes
	an update to the autopackage code as well with fixes so that
	a change to "--enable-binreloc" will get recompiled correctly.  These
	changes should address bug #978391.

2004-07-11  Carl Hetherington  <inkscape@carlh.net>

	* src/attributes.cpp, src/attributes.h: remove confusing
	snaptogrid and snaptoguides options.

	* src/desktop-events.cpp: use inkscape:guide-bbox instead of
	snaptoguides to turn guides on.

	* src/desktop.cpp: no need to worry about Snapper::getEnabled().

	* src/snap.cpp, src/snap.h: Remove explicit enabled flag from
	Snapper, as itconfuses people.  Added
	namedview_dim_snap_all_types().  Return useful stuff from
	vector_snap_list.

	* src/rect-context.cpp: Use hack to make snapping kind of work
	even with snap-to-bbox enabled.

	* src/sp-namedview.cpp, src/dialogs/desktop-properties.cpp: remove
	snaptogrid and snaptoguides options as they confuse people.  Use
	better names for the scale origin radio buttons, as suggested by
	Bulia.

	* src/seltrans.cpp: Fix some cases where snap wasn't correctly applied.

2004-07-10  MenTaLguY  <mental@rydia.net>

	* src/sp-image.cpp: prospective fix for bug #979858

	* src/select-context.cpp, src/select-context.h,
	  src/seltrans.cpp, src/seltrans.h:

	  gave SPSelTrans its own Inkscape::MessageContext, fixing
	  bug #977971

2004-07-10  Kees Cook  <kees@outflux.net>

	* src/knot.cpp: solved bug #988513: knot could stay grabbed in
	  situations where the tool went away but never got "button_release"
	  event.  This patch uses the "enter" and "leave" notifiers to disable
	  the grab before a "motion" can come and snag the knot.

2004-07-09  Kees Cook  <kees@outflux.net>

	* src/widgets/paint-selector.cpp: solved bug #984902: the pattern
	  menu was being destroyed since it was remaining part of the frame
	  that was being destroyed whenever the selector changed.  It gets
	  ref-counted, disconnected, and destroyed correctly now.
	* mkinstalldirs: automake 1.8 stopped including "mkinstalldirs", but
	  intltool still uses it.  We'll need to keep this until intltool
	  fixes the bug.  intltool 0.31 and earlier are all buggy.

2004-07-09  Carl Hetherington  <inkscape@carlh.net>

	* src/draw-context.cpp: remove some debugging g_prints.

2004-07-08  MenTaLguY  <mental@rydia.net>

	* src/interface.cpp: fixed crash on desktop context menu

	* src/desktop.h, src/desktop.cpp:

	  added SPDesktop::isWithinViewport() to conveniently determine
	  if an item is within view

	  also made isLayer() const

	* src/sp-object.h: added SPObject::hasChildren() predicate

	* src/sp-object.cpp: revert to old behavior of breaking parent
	  link before emitting "release" signal

	* src/selection-chemistry.cpp: rewrote sp_selection_item_next()
	  and sp_selection_item_prev() to work with layers

2004-07-08  Carl Hetherington  <inkscape@carlh.net>

	* src/libnrtype/FontFactory.cpp: disable printing of debug
	messages.

	* src/sp-item-group.cpp: give it a snappoints method to fix
	937318.

	* src/draw-context.cpp: fix a couple of places where Shift isn't
	checked before snapping.
	

2004-07-07  MenTaLguY  <mental@rydia.net>

	* src/desktop.cpp, src/interface.cpp: remove the word "layer"
	  for now, and disable the layer selector when the user is not
	  inside a group

2004-07-07  Kees Cook  <kees@outflux.net>

	* src/dialogs/desktop-properties.cpp: added a few g_asserts, and
	  added a missing sp_signal_disconnect_by_data for the color picker,
	  which closes bug #975864.  Stopped accidentally calling
	  sp_document_done from the update handler (fixes bug #986411).
	* src/dialogs/dialog-events.cpp, src/helper/action.cpp:
	  whitespace changes, typo fixes, added a few g_asserts.
	* src/selection-chemistry.cpp, src/desktop.cpp: when deleting items
	  from the desktop, the selection context may need to be cleared since
	  it may have pointers to the deleted items.  To do this, I just
	  reselect the current tool (fixes bug #983243).
	* src/dialogs/xml-tree.cpp, src/dialogs/desktop-properties.cpp:
	  corrected tooltips memory handling.

2004-07-06  MenTaLguY  <mental@rydia.net>

	* src/desktop.cpp: minor tweaks to make the existing layers
	  code easier to work with in its current state (particularly,
	  to sidestep some existing bugs that otherwise require more
	  UI work to fix)

2004-07-06  Carl Hetherington  <inkscape@carlh.net>

	* src/seltrans.cpp, src/sp-namedview.cpp,
	src/display/bezier-utils.cpp, src/libnr/nr-types.cpp:
	isnan appears to need a std:: namespace qualifier.

2004-07-06  Ted Gould  <ted@gould.cx>

	* src/libnr/nr-point.h, src/libnr/nr-rect.h:

	Adding in a function to round the points and rectangles.  Using this
	for less precise comparisons.  Also, added in a function to print
	each of these.

	* src/dialogs/export.cpp:

	Major revisions to do all kinds of fun stuff.  The major one being
	that filenames and and dpi's can now be stored on selections.  This
	makes it so that people working on a section of a document can export
	it consistently.

2004-07-06  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-typeset-utils.h: Greatly reduce #includes.

	* src/color-rgba.h, src/Makefile_insert, src/desktop.h:
	  Move ColorRGBA from desktop.h to new file color-rgba.h.
	* src/desktop.cpp, src/dropper-context.cpp: #include it.

2004-07-05  Kees Cook  <kees@outflux.net>

	* src/dialogs/desktop-properties.cpp, src/dialogs/rdf.cpp,
	  src/dialogs/rdf.h: added multiline data entry items, reduced
	  overall width of the dialog, and created the license entry areas.
	  Auto-detection of license on load works now.

2004-07-05  MenTaLguY <mental@rydia.net>

	* src/desktop.cpp: comitted further work which gives us a
	  partially-functional layers menu (not actually hooked up to
	  change layers yet), and it is not always updated when it needs
	  to be (yet).  It does also fix the crash though.

	* src/desktop.cpp, src/desktop.h, src/document.cpp,
	  src/sp-item-group.cpp, src/sp-item-group.h:

	  additional layers work; backed off on promoting siblings to
	  layers automatically and reintroduced "global" layer mode

2004-07-05  Carl Hetherington <inkscape@carlh.net>

	* src/desktop.cpp: prevent crash by adding a check for
	layer == NULL to SPDesktopWidget::_buildLayerStatusMenuItem.

	* src/selection-chemistry.cpp: prevent crash on copying empty
	groups.

2004-07-04  MenTaLguY  <mental@rydia.net>

	* src/sp-object.cpp: fixed bug #979281 -- I had accidentally
	  reversed the sense of a test in SPObject::requestModified(),
	  such that CHILD_MODIFIED notifications were never being sent

	* src/widgets/sp-color-notebook.cpp: always assume colors are
	  8-digit hex rrggbbaa, and zero-fill accordingly

	  HAPPY NATHAN#@$?#$#@$!?!?!?

	* src/desktop.cpp, src/desktop.h, src/document.cpp, src/document.h,
	  src/interface.cpp, src/select-context.cpp, src/selection-chemistry.cpp,
	  src/sp-item-group.cpp, src/sp-item-group.h, src/widgets/widget-sizes.h:

	  Added selection-changes-current-layer and other layer refinements.
	  Except for fixing the currently broken layer combo box on the status
	  bar, I think this is pretty much the last of the layerish work I'm
	  willing to do for 0.39 since we're in freeze now.

2004-07-03  Kees Cook  <kees@outflux.net>

	* src/document.cpp, src/dialogs/desktop-properties.cpp,
	  src/dialogs/rdf.cpp, src/dialogs/rdf.h:
	  Added several more RDF entities.  Created entry tooltips.  Set
	  a few RDF defaults for the document.

2004-07-03  MenTaLguY  <mental@rydia.net>

	* src/desktop.cpp, src/document.cpp:

	  siblings of a layer now become layers too

	* src/interface.cpp: switched to command names suggested by bulia

	* src/object-hierarchy.cpp, src/object-hierarchy.h:

	  bugfixes and cleanups
	
	* src/sp-item-group.cpp, src/sp-item-group.h, src/sp-root.cpp:

	  new layerMode() and setLayerMode() methods; SPGroupMode becomes
	  SPGroup::LayerMode

	* src/sp-object.h: added isSiblingOf() method

	* src/sp-object.cpp: leave parent pointer in place until after
	  "release" handlers finish

2004-07-02  Kees Cook  <kees@outflux.net>

	* src/document.cpp, src/dialogs/desktop-properties.cpp,
	  src/dialogs/rdf.cpp, src/dialogs/rdf.h, src/xml/repr.h:
	  Made RDF's writable now.  Handling modifications and defaults.
	  Mental and others will most likely kill me when they finally
	  read this code.

2004-07-02  MenTaLguY  <mental@rydia.net>

	* src/attributes.cpp, src/attributes.h, src/sp-item-group.cpp,
	  src/sp-item-group.h:

	  Removed the "inkscape:groupmode" attribute and added note about how
	  the group/layer mode setting needs to be per-view, not global.

	* src/desktop.cpp, src/desktop.h,
	  src/object-hierarchy.cpp, src/object-hierarchy.h:

	  Added notification signals for switching layers, as well as putting
	  groups in layer mode when they are being used as layers.

	  Notably, you can now call SPDesktop::connectCurrentLayerChanged() to
	  connect to a SigC++ signal to be notified when the current layer
	  changes.

	* src/interface.cpp, src/object-ui.cpp:

	  Fixed up the "Enter Group" and "Leave Group" context menu
	  commands a bit, and implement them both in the same places.

2004-07-02  Carl Hetherington  <inkscape@carlh.net>

	* src/desktop-snap.cpp, src/desktop-snap.h, src/snap.cpp, src/snap.h,
	src/Makefile_insert src/arc-context.cpp src/draw-context.cpp
	src/dyna-draw-context.cpp src/make.dep src/make.files src/make.ofiles
	src/makefile.msc src/nodepath.cpp src/rect-context.cpp
	src/select-context.cpp src/selection-chemistry.cpp src/seltrans.cpp
	src/sp-namedview.h src/spiral-context.cpp src/star-context.cpp:
	renamed desktop-snap.* to snap.* since it has nothing to do with the
	desktop any more.

	* src/draw-context.cpp: Temporary hack to prevent snapping
	completely failing to work when snapping to bbox points.  Support
	shift-disables-snap for freehand drawing.

	* src/snap.cpp, src/snap.h: Added some temporary methods to assist
	with hacks elsewhere.

2004-07-01  Kees Cook  <kees@outflux.net>

	* src/xml/repr.h, src/xml/repr-util.h, src/dialogs/rdf.cpp:
	  moved "repr_lookup_name" into the repr-util collection so
	  that the RDF stuff doesn't need to know about SPRepr internals.
	  Now that I've started to grok the SPRepr stuff, this seems best.
	  Added "sp_repr_recursive_drop" for use in the future when I may
	  want to throw away an entire tree of SPRepr items (like ditching
	  a blank "dc:rights" section).

2004-07-01  MenTaLguY  <mental@rydia.net>

	* src/sp-item.cpp: fix clip path loading bug

	* src/sp-object.cpp: relax analness about object ids a little

2004-06-30  Kees Cook  <kees@outflux.net>

	* src/dialogs/desktop-properties.cpp, src/dialogs/rdf.h,
	  src/dialogs/rdf.cpp: built the various functions needed to extract
	  the RDF text elements from the DOM.  XML in the document will now
	  be displayed in the entry fields.

2004-06-28  MenTaLguY  <mental@rydia.net>

	* src/xml/repr-action.cpp, src/xml/repr-action.h, src/xml/repr-css.cpp,
	  src/xml/repr-io.cpp, src/xml/repr-private.h, src/xml/repr-util.cpp,
	  src/xml/repr.cpp, src/xml/sp-repr-attr.h: applied peter's patch to
	  break out NRReprAttr

	* src/sp-object.cpp, src/sp-object.h:

	  added SPObject::nearestCommonAncestor, which given another SPObject
	  returns the nearest common ancestor of the two SPObjects.

	* src/sp-item.cpp, src/sp-item.h:

	  added SPItem::getRelativeTransform, which computes the SPItem's
	  transform relative to another SPObject

	* src/arc-context.cpp, src/draw-context.cpp, src/dyna-draw-context.cpp,
	  src/rect-context.cpp, src/spiral-context.cpp, src/star-context.cpp,
	  src/text-context.cpp:

	  drawing tools now cope with drawing within transformed groups
	  (i.e. layers)

2004-06-27  MenTaLguY  <mental@rydia.net>

	* src/sp-object.h: remove sp_object_request_update,
	  sp_object_invoke_update, sp_object_invoke_modified,
	  sp_object_request_modified, and sp_object_invoke_write, which have been
	  deprecated and are now completely unused

	* src/Makefile_insert, src/desktop.cpp, src/desktop.h,
	  src/object-hierarchy.cpp, src/object-hierarchy.h, src/sp-object.cpp,
	  src/sp-object.h:

	  Implemented SPDesktop::setCurrentLayer(), introducing
	  Inkscape::ObjectHierarchy to permit falling back to parents if
	  the current layer is removed.

	* src/object-ui.cpp, src/interface.cpp: really crude hack of
	  Sodipodi-like "enter group" and "leave group"

2004-06-26  MenTaLguY  <mental@rydia.net>

	* src/refcounted.h: allow reffing/unreffing const objects

	* src/arc-context.cpp, src/draw-context.cpp, src/dropper-context.cpp,
	  src/event-context.cpp, src/event-context.h, src/node-context.cpp,
	  src/rect-context.cpp, src/selcue.cpp, src/selcue.h,
	  src/select-context.cpp, src/select-context.h, src/seltrans.cpp,
	  src/seltrans.h, src/spiral-context.cpp, src/star-context.cpp,
	  src/text-context.cpp, src/zoom-context.cpp:

	  Make SPSelTrans and SPSelCue proper C++ classes with constructors.

	* src/document.h, src/dialogs/xml-tree.cpp: removed sp_document_lookup_id

	* src/sp-object.cpp: clarify what is happening with bug #980407 --
	  the clone is getting attached to the repr before the original SPObject
	  is.

2004-06-26  Carl Hetherington  <inkscape@carlh.net>

	* src/node-context.cpp: make sure nodepath->nodeContext is set up
	when the selection changes.  Fixes 936739.

2004-06-25  MenTaLguY  <mental@rydia.net>

	* src/display/sp-canvas.cpp: enabled win32 current item workaround on
	  all platforms

2004-06-25  Kees Cook  <kees@outflux.net>

	* src/dialogs/rdf.h, src/dialogs/rdf.cpp, src/dialogs/Makefile_insert,
	  src/dialogs/desktop-properties.cpp:

	  Added data entry widgets for document metadata, including a rough
	  license selector, and debug rdf generator.  Corrected whitespace,
	  added table for RDF entity lookup, tag, and title mapping.  Added
	  initial loading framework.  Cleaned up rdf_work_entity_t usage.

2004-06-25  Carl Hetherington  <inkscape@carlh.net>

	* src/sp-namedview.cpp: cleanups in grid snap settings.  Fix a
	typo.

	* src/seltrans.cpp: optional default origin for scaling.  Fixes
	to snap during scale.

	* src/seltrans.h: s/opposit/opposite/.  Add some comments.

	* src/dialogs/display-settings.cpp: add default scale origin
	option.

	* src/desktop-snap.h: changes to snap_list_scale prototype.

	* src/desktop-snap.cpp: snap_list_scale now returns whether
	it snapped or not.  The best scale snap is now the one that
	changes the scale factor least, rather than the one that
	results in the snap point being closest to where it used to be.

	* src/display/sp-canvas.cpp: fix for win32 freeze-at-border bug,
	copied from SP.

	* src/knot.cpp, src/select-context.cpp: change spellings from
	British to American English for translators.
	
2004-06-24  rejon <kidproto@users.sf.net>

	* src/verbs.cpp: I changed the reverse command to be more verbose and
	  explanative.

2004-06-24  MenTaLguY  <mental@rydia.net>

	* src/seltrans.cpp: slight change to make showing/hiding center
	  mark easier later on

	* configure.in, src/main.cpp, src/star-context.cpp,
	  src/display/bezier-utils.cpp, src/display/canvas-bpath.cpp,
	  src/display/nr-arena-glyphs.cpp, src/display/nr-arena-shape.cpp,
	  src/display/sp-ctrlline.cpp, src/libnr/nr-svp.cpp,
	  src/libnrtype/FontFactory.cpp, src/libnrtype/RasterFont.cpp,
	  src/livarot/AlphaLigne.cpp, src/livarot/BitLigne.cpp,
	  src/livarot/Ligne.cpp, src/livarot/PathOutline.cpp,
	  src/livarot/ShapeMisc.cpp, src/widgets/font-selector.cpp:

	  fixes for floating-point portability issues, courtesy of
	  Colin Marquardt.

	* src/extensions/init.cpp: dirent.h requires inttypes.h on OS X

2004-06-23  MenTaLguY  <mental@rydia.net>

	* src/Makefile_insert, src/desktop.cpp, src/managed.h,
	  src/message-context.cpp, src/message-stack.h, src/refcounted.h,
	  src/selection.h, src/view.cpp:

	  Changed my mind.

	  Inkscape::Managed is more properly called Inkscape::Refcounted

	* src/libnrtype/Makefile_insert, src/libnrtype/codepages.h,
	  src/libnrtype/cp1250.cpp, src/libnrtype/cp1251.cpp,
	  src/libnrtype/cp1252.cpp, src/libnrtype/cp1253.cpp,
	  src/libnrtype/cp1254.cpp, src/libnrtype/cp1255.cpp,
	  src/libnrtype/cp1256.cpp, src/libnrtype/cp1257.cpp,
	  src/libnrtype/cp1258.cpp, src/libnrtype/cp874.cpp,
	  src/libnrtype/cp932.cpp, src/libnrtype/cp936.cpp,
	  src/libnrtype/cp949.cpp, src/libnrtype/cp950.cpp:

	  removed unused Win32 codepage crap

2004-06-23  Carl Hetherington  <inkscape@carlh.net>

	* src/inkscape.cpp: Don't connect to SIGBUS on Win32, as
	it doesn't seem to exist.  Add Emacs mode line.
	Declaration-to-first-use and coding style cleanups.

	* src/desktop-snap.h: a few double -> NR::Coord fixes.

	* src/nodepath.cpp: turn off snapping when Shift is held down.
	Some minor cleanups.

	* src/dialogs/display-settings.cpp: remove my rather dubious
	move_with_grid option.

	* src/select-context.cpp: rationalise grid modifiers; now Shift
	disables snap and Alt snaps movement to the grid.

2004-06-23  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* share/extensions/dia2svg.sh: Fix bashism and insecure tempfile usage.

2004-06-23  Ted Gould  <ted@gould.cx>

	* share/extensions/dropshadow.inkmod, share/extensions/roundhole.inkmod,
	src/extension/system.cpp:

	Setting it up so that poorly formed inkmod files generate actual GTK
	warnings so that they can be easily hidden.  Also, fixing these two inkmod
	files so that they don't generate the above mentioned warnings.

2004-06-22  Kees Cook  <kees@outflux.net>

	* src/inkscape.cpp: added SIGBUS and SIGABRT handling.

2004-06-22  John Cliff <simarilius@yahoo.com>

	* src/object-edit.cpp: 	Added knots for manipulation of pattern fills.
	* src/sp-shape.cpp, src/sp-shape.h: 	Added sp_shape_set_pattern to
	explictly set the transform rather than multiplying like adjust.


2004-06-22  Carl Hetherington  <inkscape@carlh.net>

	* src/sp-shape.cpp: add sp_shape_snappoints.

	* src/desktop-snap.cpp: minor cleanups.  Added a comment.

	* src/sp-text.cpp: removed an old comment.

	* src/sp-ellipse.cpp: fix snappoints method now that the parent
	class method has changed.

	* src/sp-rect.cpp: snappoints method is not required as it's now
	handled by SPShape.

	* src/sp-image.cpp: use SPItem's snappoints method.

	* src/file.cpp: fix another call to g_file_test with a
	possibly-NULL parameter.  Fixes #977413.

2004-06-21  Carl Hetherington  <inkscape@carlh.net>

	* src/file.cpp: don't call g_file_test with a NULL path.  Fixes
	#976703.
	
	* src/desktop-snap.cpp: default to snapping to bounding boxes when
	snapping is first enabled.  Rework in terms of SPNamedView rather
	than SPDesktop.

	* src/desktop-snap.h: rework in terms of SPNamedView rather than
	SPDesktop.

	* src/arc-context.cpp, src/draw-context.cpp,
	src/dyna-draw-context.cpp, src/nodepath.cpp src/rect-context.cpp,
	src/select-context.cpp, src/selection-chemistry.cpp,
	src/seltrans.cpp, src/sp-namedview.cpp, src/spiral-context.cpp,
	src/star-context.cpp: Adapt for changes to snap code naming.

	* src/seltrans.cpp: cleanups to sp_sel_trans_skew_request and
	sp_sel_trans_scale_request.

2004-06-20  Ted Gould  <ted@gould.cx>

	* share/extensions/ai_input.inkmod, share/extensions/ai_output.inkmod,
	share/extensions/dia.inkmod, share/extensions/dropshadow.inkmod,
	share/extensions/epsi_output.inkmod, share/extensions/roundhole.inkmod,
	share/extensions/svgz_input.inkmod, share/extensions/svgz_output.inkmod,
	share/extensions/txt2svg.inkmod, src/extension/extension.h,
	src/extension/system.cpp, src/extension/implementation/script.cpp,
	src/extension/internal/eps-out.cpp,
	src/extension/internal/gdkpixbuf-input.cpp,
	src/extension/internal/gnome.cpp, src/extension/internal/ps-out.cpp,
	src/extension/internal/ps.cpp, src/extension/internal/svg.cpp,
	src/extension/internal/win32.cpp:

	Changing the the naming of the extensions to be more Java style naming to
	allow for more extension in the future.

2004-06-21  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/extension/internal/ps.cpp (PrintPS): Initialize _stream to
	  NULL (fixes segfaults when exporting to an unopenable file), and
	  initialize _bitmap to false instead of random.

2004-06-20  MenTaLguY  <mental@rydia.net>

	* src/desktop.cpp, src/managed.h, src/message-context.h,
	  src/message-stack.h, src/message.h, src/view.cpp:

	  Document classes, and change Managed to have an initial refcount
	  of one at creation.

2004-06-20  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/libnrtype/FontFactory.cpp, src/libnrtype/FontInstance.cpp,
	  src/libnrtype/font-instance.h: If both WIN32 and WITH_XFT are
	  defined, then use just the WITH_XFT code.  (I don't know if it's
	  possible for both to be defined, but we might as well document
	  that the existing code doesn't handle both being defined, AFAICT.)

	* src/libnrtype/FontFactory.cpp (ink_strstr): Document brokenness.
	  (is_regular, is_nonbold, is_italic, etc.): Mark as static.

	* src/Makefile.am (EXTRA_DIST): Remove reference to deleted files
	  libnrtype/nr-type-w32.cpp, libnrtype/nr-type-w32.h,
	  libnrtype/nr-type-xft.cpp, libnrtype/nr-type-xft.h.

	* src/config.h.win32: Define PACKAGE_TARNAME, for require-config.h.
	  More accurate mathematical constants (20 decimal places instead of 3).

2004-06-19  MenTaLguY  <mental@rydia.net>

	* src/desktop.cpp, src/managed.h, src/rect-context.cpp,
	  src/rect-context.h, src/selection.h, src/view.cpp:

	  SPSelection now derives from Inkscape::Managed

	* src/Makefile_insert, src/select-context.cpp, src/select-context.h,
	  src/selection-describer.h, src/selection-describer.cpp:

	  Introduced Inkscape::SelectionDescriber to which SPSelectContext
	  delegates the task of displaying descriptions of the current
	  selection.  This fixes bug #945735.

2004-06-19  Carl Hetherington  <inkscape@carlh.net>

	* src/desktop-snap.{cpp,h}: sp_desktop_dim_snap_list returns
	whether or not it snapped anything.

	* src/select-context.cpp: fix snap on move behaviour (again)

	* src/widgets/dash-selector.cpp: fix off-by-one spotted by
	valgrind.
	
2004-06-19  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/extension/internal/ps.cpp (begin): Add some basic error handling.

	* src/extension/internal/ps.cpp (setup): Simplify an expression now that
	  _bitmap is a bool.

	* src/extension/internal/ps.h: Twiddle the order of the fields.
	  Replace bitfields with bool/short.

	* src/libnrtype/Makefile_insert, src/libnrtype/FontInstance.h,
	  src/make.files, src/make.ofiles, src/make.dep:
	  Remove src/libnrtype/FontInstance.h (see change below).

	* src/libnrtype/RasterFont.h, src/libnrtype/raster-glyph.h,
	  src/libnrtype/raster-position.h:
	  Move raster_glyph, raster_position from RasterFont.h to new files
	  raster-glyph.h, raster-position.h.
	* src/libnrtype/Makefile_insert: Add the new files to SOURCES.

	* src/libnrtype/FontInstance.h, src/libnrtype/font-glyph.h,
	  src/libnrtype/font-instance.h, src/libnrtype/font-style.h:
	  Move font_glyph, font_instance, and font_style definitions from
	  FontInstance.h into new files font-glyph.h, font-instance.h,
	  font-style.h.
	* src/libnrtype/Makefile_insert: Add the new files to SOURCES.

	* src/libnrtype/nrtype-forward.h: New file.
	* src/libnrtype/Makefile_insert: Add it to SOURCES.
	* src/libnrtype/FontFactory.h, src/libnrtype/TextWrapper.h:
	  #include it (replacing local declarations in some cases).

	* src/livarot/livarot-forward.h: New file.
	* src/livarot/Ligne.h, src/livarot/Path.h, src/livarot/Shape.h:
	  #include it (replacing local declarations in some cases).
	* src/livarot/Makefile_insert: Add it to SOURCES.

2004-08-18  Ted Gould  <ted@gould.cx>

	* src/file.cpp, src/preferences-skeleton.h:

	Adding the feature that the save and open directories are saved in the
	preferences.  The last one will be used.

2004-08-18  Carl Hetherington  <inkscape@carlh.net>

	* src/widgets/font-selector.cpp: uint -> guint to fix
	compile errors.

	* src/desktop-snap.{cpp,h}: make snap functions aware of the
	type of point they are snapping, so they can decide whether
	to ignore it.

	* src/arc-context.cpp, src/rect-context.cpp,
	src/spiral-context.cpp, src/star-context.cpp,
	src/draw-context.cpp, src/dyna-draw-context.cpp, src/nodepath.cpp,
	src/selection-chemistry.cpp, src/seltrans.cpp:
	temporarily update for changes to snapping API.

	* src/sp-namedview.cpp, src/dialogs/desktop-properties.cpp:
	adapt for small changes to Snapper API.

	* src/select-context.cpp: use new snapping API.

2004-08-17  Bryce Harrington  <bryce@bryceharrington.org>

	*  nodepath.cpp path-chemistry.cpp selection-chemistry.cpp,
	   seltrans.cpp sp-typeset.cpp splivarot.cpp text-context.cpp,
	   tools-switch.cpp dialogs/find.cpp:  Converting statusbar
	   messages from old style to new, as per
	   http://inkscape.org/cgi-bin/wiki.pl?StatusbarAPI

2004-06-18  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/mkdep.pl: Add `by mkdep.pl' to `automatically generated' line.

	* src/dialogs/desktop-properties.cpp:
	  Greater conformance to CodingStyle.  Add FIXME comment.

	* src/sp-namedview.cpp: Tighter scoping for iteration var.
	  Simplify some code by greater use of cheap sp_unit_get_by_id.

2004-06-17  MenTaLguY  <mental@rydia.net>

	* src/Makefile_insert, src/arc-context.cpp, src/arc-context.h,
	  src/desktop-events.cpp, src/desktop.cpp, src/desktop.h,
	  src/draw-context.cpp, src/dropper-context.cpp, src/event-context.cpp,
	  src/event-context.h, src/file.cpp, src/interface.cpp, src/knot.cpp,
	  src/managed.h, src/message-context.cpp, src/message-context.h,
	  src/message-stack.cpp, src/message-stack.h, src/message.h,
	  src/select-context.cpp, src/view.cpp, src/view.h,
	  src/libnrtype/FontFactory.cpp, src/libnrtype/nr-type-primitives.h,
	  src/widgets/font-selector.cpp:

	  New status messages primitives (statusbar bug not fixed yet though).

2004-06-17  Carl Hetherington  <inkscape@carlh.net>

	* src/helper/stock-items.cpp: fix a compiler warning.  Minor
	coding style cleanups.

	* src/arc-context.cpp, src/desktop-snap.cpp, src-desktop-snap.h,
	src/rect-context.cpp, src/spiral-context.cpp,
	src/star-context.cpp: Replace desktop.h include with forward
	references in desktop-snap.h, and add desktop.h includes in
	files which require them.

	* src/widgets/spw-utilities.cpp, src/widgets/spw-utilities.h:
	add spw_vbox_checkbutton.

	* src/attributes.cpp, src/attributes.h, src/sp-namedview.cpp,
	src/sp-namedview.h, src/desktop-snap.cpp, src/desktop-snap.h,
	src/desktop.cpp, src/desktop.h,
	src/dialogs/desktop-properties.cpp, src/seltrans.cpp,
	src/seltrans.h, src/selection.cpp, src/selection.h,
	src/select-context.cpp, src/selection-chemistry.cpp:

	Start of new and hopefully improved snapping code.

2004-06-17  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/helper/units.h, src/helper/units.cpp:
	  (sp_unit_get_by_id): new function.
	  (sp_convert_distance_full): Change arguments & return value.
	  Call g_log if no conversion possible.
	  Callers updated.
	  (sp_unit_get_default, sp_unit_get_by_name): Remove unused functions.
	  sp_units: Less rounding error in unittobase.

2004-06-16  Carl Hetherington  <inkscape@carlh.net>

	* src/sp-item.h: added a comment.

2004-06-15  Ted Gould  <ted@gould.cx>

	* share/extensions/ai_input.inkmod:
	Removing the command-line argument to specify line endings.

	* src/print.cpp, src/print.h, src/sp-text.cpp,
	src/extension/extension.cpp, src/extension/extension.h,
	src/extension/implementation/implementation.cpp,
	src/extension/implementation/implementation.h,
	src/extension/internal/ps.cpp, src/extension/internal/ps.h:

	Changing it so that the text to vector is its own function.  This way it
	can be used as a parameter in Postscript, but then can be easily used for
	drivers which only support vector drawing.

2004-06-16  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/select-toolbar.cpp: Cleanups and preparation for px units.

	* src/helper/units.h, src/helper/units.cpp:
	  Add reference version of sp_points_get_units, sp_units_get_points.
	  Implement as simple multiplication instead of sp_convert_distance.
	  (sp_units_table_sane): New function.
	* src/helper/units-test.cpp: Test sp_units_table_sane.

	* src/sp-object-repr.cpp: Move some declarations to first use.
	* src/sp-object-repr.h, src/sp-object-repr.cpp (sp_object_type_register):
	  Change return type to void.

	* src/sp-item.cpp (sp_item_repr_compare_position):
	  Reimplement as shallow wrapper around sp_repr_compare_position.

	* src/helper/units.h, src/helper/units.cpp:
	  SPUnitId: new enum, to allow replacing string lookups.
	  Get rid of handling for unused SP_UNIT_USERSPACE.
	  Remove unused SPUnit.version field.

	* src/helper/units-test.cpp (test_bases): Test sp_unit_get_identity.

	* src/helper/Makefile_insert (helper_units_test_LDADD): Fix the previous
	  commit: -lglib-2.0 instead of -lglib.

2004-06-15  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/Makefile.am, src/helper/Makefile_insert,
	  src/helper/units-test.cpp:
	  New unit test file units-test.cpp.

	* src/select-toolbar.cpp: Greater conformance to CodingStyle.

2004-06-14  Carl Hetherington  <inkscape@carlh.net>

	* src/libnrtype/TextWrapper.cpp: Fix what looks like an off-by-one.

	* ChangeLog, src/prefs-utils.cpp:
	Fix bracketing typo that causes an array to be overrun.

2004-06-14  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-path.cpp: Move some declarations to first use.

2004-06-13  Kees Cook  <kees@outflux.net>

	* src/xml/repr.h, src/xml/repr-utils.cpp: adding additional RDF URIs
	to the default namespace prefix list.

2004-06-13  MenTaLguY  <mental@rydia.net>

	* src/arc-context.cpp, src/desktop.cpp, src/desktop.h, src/document.cpp,
	  src/document.h, src/draw-context.cpp, src/dyna-draw-context.cpp,
	  src/file.cpp, src/gradient-chemistry.cpp, src/interface.cpp,
	  src/rect-context.cpp, src/selection-chemistry.cpp, src/sp-object.cpp,
	  src/sp-object.h, src/spiral-context.cpp, src/splivarot.cpp,
	  src/star-context.cpp, src/svg-view.h, src/text-context.cpp,
	  src/extension/internal/gdkpixbuf-input.cpp:

	  added SPDesktop::currentRoot() and SPDesktop::currentLayer(), which
	  report the current "view" root and current "editing" layer,
	  respectively; I've also added SPObject::appendReprChild().

	  Between the two of them, they replace sp_document_add_repr, which
	  has been removed.  Generally to add a repr to a document, you would
	  now use either:

	   SP_DOCUMENT_DEFS(document)->appendReprChild(repr);

	  or:

	   desktop->currentLayer()->appendReprChild(repr);

2004-06-13  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-clippath.h, src/sp-gradient.h, src/sp-marker.h, src/sp-mask.h, src/sp-pattern.h:
	  Explicitly mark _acceptObject as virtual.
	  (Already declared as virtual in base class.)

	* src/file.cpp, src/main.cpp: Greater conformance to CodingStyle.

	* src/node-context.h, src/selcue.h, src/sp-pattern.h,
	  src/widgets/sp-color-wheel-selector.h:
	  Add missing includes as found by src/check-header-compile.

	* src/Makefile_insert:
	* src/sp-use-reference.cpp:
	* src/sp-use-reference.h:
	* src/sp-use.cpp:
	* src/sp-use.h:
	  Move SPUseReference from sp-use.h to new files sp-use-reference.h,
	  sp-use-reference.cpp.

	* src/sp-use.h (_acceptObject): Fix can't-use-ancestor check.

	* src/uri-references.h (getOwner): Fix copy&paste bug.

2004-06-11  MenTaLguY  <mental@rydia.net>

	* src/sp-object.h, src/sp-object.cpp:

	  migrated several SPObject methods to C++ methods:

	  sp_object_invoke_write -> SPObject::updateRepr
	  sp_object_request_update -> SPObject::requestDisplayUpdate
	  sp_object_invoke_update -> SPObject::updateDisplay
	  sp_object_request_modified -> SPObject::requestModified
	  sp_object_invoke_modified -> SPObject::emitModified

	  (leaving deprecated wrappers in place for now)

	* src/document.cpp, src/object-edit.cpp, src/sp-clippath.cpp,
	  src/sp-defs.cpp, src/sp-ellipse.cpp, src/sp-image.cpp,
	  src/sp-item-group.cpp, src/sp-item.cpp, src/sp-line.cpp,
	  src/sp-marker.cpp, src/sp-mask.cpp, src/sp-offset.cpp,
	  src/sp-pattern.cpp, src/sp-rect.cpp, src/sp-root.cpp,
	  src/sp-shape.cpp, src/sp-spiral.cpp, src/sp-star.cpp,
	  src/sp-symbol.cpp, src/sp-text.cpp, src/sp-typeset.cpp,
	  src/sp-use.cpp, src/dialogs/stroke-style.cpp, src/sp-path.cpp:

	  transitioned to SPObject::requestDisplayUpdate and
	  SPObject::updateDisplay

	* src/arc-context.cpp, src/document.cpp, src/gradient-chemistry.cpp,
	  src/knotholder.cpp, src/main.cpp, src/rect-context.cpp,
	  src/sp-anchor.cpp, src/sp-clippath.cpp, src/sp-defs.cpp,
	  src/sp-gradient.cpp, src/sp-item-group.cpp, src/sp-item.cpp,
	  src/sp-mask.cpp, src/sp-namedview.cpp, src/sp-object-group.cpp,
	  src/sp-object.cpp, src/sp-object.h, src/sp-offset.cpp,
	  src/sp-pattern.cpp, src/sp-rect.cpp, src/sp-shape.cpp,
	  src/sp-spiral.cpp, src/sp-text.cpp, src/sp-use.cpp,
	  src/spiral-context.cpp, src/splivarot.cpp, src/star-context.cpp,
	  src/style.cpp, src/toolbox.cpp, src/dialogs/fill-style.cpp,
	  src/dialogs/stroke-style.cpp, src/extension/internal/svg.cpp:

	  transitioned to SPObject::requestModified, SPObject::emitModified,
	  and SPObject::updateRepr; also reworked "minimal" version of
	  updateRepr.

	* src/sp-object.h: added a little documentation

	* src/document.cpp, src/document.h, src/file.cpp,
	  src/gradient-chemistry.cpp, src/help.cpp, src/object-ui.cpp,
	  src/selection-chemistry.cpp, src/selection.cpp, src/seltrans.cpp,
	  src/sp-clippath.cpp, src/sp-item-group.cpp, src/sp-mask.cpp,
	  src/sp-namedview.cpp, src/sp-object.cpp, src/sp-offset.cpp,
	  src/sp-pattern.cpp, src/sp-root.cpp, src/sp-text.cpp,
	  src/sp-typeset.cpp, src/sp-use.cpp, src/splivarot.cpp,
	  src/uri-references.cpp, src/dialogs/fill-style.cpp,
	  src/dialogs/item-properties.cpp, src/dialogs/stroke-style.cpp,
	  src/helper/stock-items.cpp, src/widgets/gradient-selector.cpp,
	  src/widgets/gradient-vector.cpp, src/widgets/icon.cpp:

	  replaced sp_document_lookup_id with SPDocument::getObjectById,
	  and SPDocument::getObjectByRepr

	  (left deprecated stub in place, but it should be unused at this point)

2004-06-11  Ted Gould  <ted@gould.cx>

	* src/file.cpp, src/inkscape.cpp, src/interface.cpp, src/prefs-utils.cpp,
	src/prefs-utils.h:

	Moving the recent document setting and getting code into the prefs-utils
	files so that they'll be with the preferences (which they really kinda
	are).  Then, moved the place where they are set from the removing of the
	document to where the files are opened and 'save as'd.  (yes, I made up a
	word/contraction).

2004-06-10  Carl Hetherington  <inkscape@carlh.net>

	* src/desktop-snap.cpp, src/desktop-snap.h,
	src/satisfied-guide-cns.cpp, src/satisfied-guide-cns.h,
	select-context.cpp, selection.cpp, selection.h, seltrans.cpp,
	seltrans.h, sp-ellipse.cpp, sp-image.cpp,
	sp-item-notify-moveto.cpp, sp-item-rm-unsatisfied-cns.cpp,
	sp-item-update-cns.cpp, sp-item.cpp, sp-item.h, sp-offset.cpp,
	sp-rect.cpp, sp-spiral.cpp, sp-star.cpp, sp-text.cpp:

	Use a std::vector to store snap points, rather than a fixed-size
	array.

2004-06-09  Carl Hetherington  <inkscape@carlh.net>

	* src/desktop-snap.cpp, src/desktop-snap.h: Coding style fixes.
	Use NR::Coord rather than double where appropriate.  Added some
	comments.  Use NR::Dim2 where appropriate.  Use NR_HUGE rather
	than hardcoded 1e18s.

	* src/rect-context.cpp, src/nodepath.cpp, src/arc-context.cpp:
	Adapt for changes to sp_desktop_dim_snap prototype.

	* src/select-context.cpp:
	Adapt for changes to sp_desktop_dim_snap_list prototype.

2004-06-08  MenTaLguY  <mental@rydia.net>

	* src/display/sp-canvas.h, src/livarot/DblLinked.h,
	  src/livarot/LivarotDefs.h, src/livarot/AVL.h, src/livarot/Shape.h,
	  src/livarot/ShapeUtils.h, src/livarot/Ligne.h,
	  src/object-edit.cpp, src/spiral-context.cpp, src/sp-shape.cpp:

	  Portability fixes from Colin Marquardt <colin@marquardt-home.de>.

2004-06-08  Carl Hetherington  <inkscape@carlh.net>

	* src/main.cpp: remove the call to
	Extension::Internal::PrintWin32::init() entirely after Ted pointed
	out that it would be called by code in src/extension/init.cpp
	anyway.

2004-06-08  Ted Gould  <ted@gould.cx>

	* src/main.cpp:

	Added in a version command to our command line args.  This fixes
	enhancement request 968642.

2004-06-07  MenTaLguY  <mental@rydia.net>

	* src/document.cpp, src/document.h, src/document-undo.cpp,
	  src/sp-object.h, src/sp-object.cpp:
	  renamed object garbage collection routines to fit the "orphan"
	  terminology

2004-06-07  Carl Hetherington <inkscape@carlh.net>

	* src/main.cpp: tentative fix for startup crash on Win32.  Ensure
	that Extension::Internal::PrintWin32::init() is not called until
	after inkscape_application_init().

2004-06-07  Ted Gould  <ted@gould.cx>

	* src/inkscape.cpp, src/main.cpp:

	Moving the initialization of the extensions into the Inkscape application
	init.  I have mixed feelings on this.  One one hand, basically extension
	init gets called directly after applicaiton init and extensions init has
	nothing to do with anything else in main.  On the other hand I'm not sure
	that it is directly related to the structure of the application itself.
	Comments are welcome.

2004-06-06  MenTaLguY  <mental@rydia.net>

	* src/attributes.cpp, src/attributes.h: added inkscape:collect attribute
	  to specify orphan collection policy (collect with parent, or always
	  collect)

	* src/document-undo.cpp, src/document.cpp, src/document.h: added an orphan
	  collection pass as part of comitting an undo step

	* src/sp-object.cpp, src/sp-object.h:
	  add total hrefcount for all descendants, and basic orphan collection
	  facilities

	* src/gradient-chemistry.cpp, src/dialogs/stroke-style.cpp,
	  src/extension/internal/gdkpixbuf-input.cpp:
	  mark automatically added gradients, patterns, and markers for orphan
	  collection

2004-06-06  Bryce Harrington <bryce@bryceharrington.org>

	* libnrtype/nr-type-xft.cpp, libnrtype/nr-font.cpp,
	  libnrtype/nr-rasterfont.cpp, libnrtype/nr-type-directory.cpp,
	  libnrtype/nr-typeface.cpp, libnrtype/nr-type-w32.cpp, 
	  libnrtype/nr-type-ft2.cpp, libnrtype/nr-type-pos-def.cpp,
	  libnrtype/nr-type-primitives.cpp:

	Documenting the routines.  This adds basic code docs for
	everything in libnrtype.  

2004-06-06  Ted Gould  <ted@gould.cx>

	* src/main.cpp, src/preferences-skeleton.h, src/extension/extension.cpp:

	Making it so that the extension parameters get saved in the Inkscape
	preferences.  Most people will notice that their printer gets saved now.
	But this does alot more than that.  Added an "extensions" group to the
	preferences skeleton for all these settings.  All settings get saved as
	"module ID"."param name".  Also had to change where the extensions get
	init'd in the startup to put it behind the Inkscape application so that
	prerefences could be used.

2004-06-03  Ted Gould  <ted@gould.cx>

	* src/file.cpp, src/dialog/filedialog.cpp:

	Making the whole file dialog alot more fun.  Basically, now the
	first filename will always be unique on files that don't have a
	filename already.  And, if you've selected a different default
	extension, that extension's filename extension will be placed
	on the file.  Also, when you change the extension to save with
	in the dialog, the filename extension will change with you (assuming
	that you were using filename extensions previously ofcourse).
	Finally, the checkbox to autoappend extensions is no insensitive
	when "Autodetect" is selected.

2004-06-03  MenTaLguY  <mental@rydia.net>

	* src/file.cpp, src/extension/internal/ps.cpp,
	  src/extension/internal/win32.cpp, src/sp-pattern.cpp,
	  src/dialogs/stroke-style.cpp, src/display/nr-arena-glyphs.cpp,
	  src/display/nr-arena-group.cpp, src/display/nr-arena-image.cpp,
	  src/display/nr-arena-item.cpp, src/display/nr-arena-shape.cpp,
	  src/widgets/icon.cpp, src/dialogs/nr-arena-item.h:

	  Introduced the notion of "parent" NRGCs

2004-06-02  bulia byak <bulia@users.sourceforge.net>

	* src/selection.h, src/selection.cpp:

	* preferences-skeleton.h dialogs/display-settings.cpp sp-item.cpp: New settings
	for various compensations

	* sp-shape.cpp sp-shape.h sp-rect.cpp sp-path.cpp: Factored out adjustments
	(stroke and pattern so far) from optimizing items into sp-shape.

	* libnr: Added distance function for a couple of points. Added expansions for X and Y.

	* object-edit.cpp sp-rect.cpp sp-item.cpp toolbox.cpp: Made rect use absolute
	radii, added recursive compensation on item_transform. Added new knot for
	rect, moved corner knots to the top right corner. Rect toolbar shows visible
	rx/ry.

	* toolbox.cpp: Finally got the freeze semaphores right (prevent loops for
	changes both from the repr and from toolbar UI).

	* sp-namedview.cpp: Guarding against nan in zoom, cx, cy

	* select-toolbar.cpp helper/unit-menu.cpp helper/unit-menu.h: Fix units menu size

	* node-context.cpp: Second Esc or empty-click deselects object

	* desktop.cpp desktop.h: Restored sticky zoom 

	* preferences-skeleton.h extension/internal/gdkpixbuf-input.cpp file.cpp: Do not
	group import if only one item; move its defs to our defs; select and move
	under cursor the imported item/group. Optionally import bitmaps as filled
	rects.

	* many -context files: Decoupled seltrans and selcue so that the latter can be
	used outside of selector; enabled optional selcue in all tools

	* many files: New set_color signals on desktop, switching the dropper to them;
	needs to be redone for style. Excise the old inkscape::color_set signal.

	* dialogs/stroke-style.cpp: Fix the "all clubs" marker preview bug. In markers
	menu, skip document markers with stockid only if the same stockid is in
	markers.svg; add separator.

	* many fill and stroke files: Remove old mode selector, remove dropper checkbox
	(now always on). Remember active colorselector page. Remove redundant checks
	in setting color (fixes at least one bug). Cosmetics, cleanup, b/w icons,
	shortened labels, added mnemonics and tooltips, removed the drop-down modes
	list. Switched color spinbuttons to 0..255 enabling 0..1 floats to be typed as
	well.

	* dialogs/find.* et al: Find dialog, command 

	* selection-chemistry.cpp: Fix copying objects from different parents; fix and
	reorganize copying gradients, recurse into groups

	* dialogs/xml-tree.cpp: Removed unused desktop shutdown signal, fixes problem
	with saving window settings on exit

	* select-toolbar.cpp: Percentage unit, lock toggle, NR::Rectification

	* sp-object.cpp path-chemistry.cpp splivarot.cpp et al: Sending _delete_signal
	recursively for descendants; switched to deleteObject where appropriate to
	notify clones

	* preferences-skeleton.h desktop.cpp desktop.h interface.cpp: Window layout
	fully configurable, commands in the View menu

	* path-chemistry.cpp: Fixed transform when combining inside group

	* preferences-skeleton.h sp-item.cpp dialogs/display-settings.cpp: Fixes in
	scalestroke (coded by Carl): arbitrary depth recusion, setting stroke-width
	via repr, pref in the transforms tab

	* widgets/sp-xmlview-attr-list.cpp: More robust listener 

2004-06-01  Ted Gould  <ted@gould.cx>

	* src/extension/internal/gdkpixbuf-input.cpp:
	Making it so that the lists of extensions and mimetypes are
	used in the creation of the plugins.  Also, free'ing everything
	properly so that we don't have a memory leak.

2004-05-30  MenTaLguY  <mental@rydia.net>

	* src/selection.h, src/selection.cpp:
	  rework SPSelection to be SPObject- rather than SPItem- oriented;
	  this will be needed later for the layers/document tree dialog
	  (and could prove useful for the XML editor later too)

	* src/sp-item.h: make SPItem a proper C++ subclass of SPObject

	* src/dialogs/item-properties.cpp:
	  correct overly intimate knowledge of SPObject (use SP_OBJECT_ID rather
	  than directly accessing the SPObject::id member)

2004-05-27  Kees Cook  <kees@outflux.net>

	* src/extension/internal/ps.h, src/extension/internal/ps.cpp:
	  Hopefully fixed the locale problems in the PS output generator.
	* src/sp-offset.cpp, src/display/bezier-utils-test.cpp,
	  src/display/nr-arena-item.cpp, src/libnr/nr-svp-render.cpp,
	  src/libnr/testnr.cpp, src/livarot/AlphaLigne.cpp,
	  src/livarot/Ligne.cpp, src/livarot/Path.cpp,
	  src/livarot/PathCutting.cpp, src/livarot/Shape.cpp,
	  src/livarot/ShapeDraw.cpp, src/livarot/ShapeSweep.cpp,
	  src/svg/svg-affine.cpp: added comments and notes to all remaining
	  "printf"ish calls that have %g or %f in them.  Most are just debug
	  output, etc.  Hopefully we are actually free of locale bugs!  :)
	* src/desktop.h, src/desktop.cpp: desktop's knowledge of
	  fullscreen-ness doesn't depend on having the ability to DO it.  Other
	  functions already test "is_fullscreen" to alter their behavior.

2004-05-23  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/extension/system.h, src/extension/system.cpp (build_from_file):
	  Remove unused second argument.  Callers updated.
	* src/extension/system.cpp (build_from_reprdoc):
	  Just one call to sp_repr_name per child.
	* src/extension/system.h, src/extension/system.cpp:
	  Cleanup: greater conformance to CodingStyle.

2004-05-23  MenTaLguY  <mental@rydia.net>

	* src/libnrtype/Makefile_insert, src/libnrtype/nr-type-gnome.cpp,
	  src/libnrtype/nr-type-gnome.h, src/libnrtype/nr-type-dictionary:

	  removed gnome-print libnrtype backend

2004-05-20  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/xml/repr.h, src/xml/repr-util.cpp:
	  Remove unused function sp_repr_set_position_relative.

	* src/xml/repr-util.cpp (sp_repr_compare_position, sp_repr_position):
	  Minor cleanups.

2004-05-19  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-use.cpp: Cleanup: greater conformance to CodingStyle.

	* src/sp-item-group.cpp (sp_item_group_ungroup): Fix bug #956334:
	  ungrouping was reversing the order of the group members.

	* src/xml/repr-get-children.h, src/xml/repr-get-children.cpp: New files.
	* src/xml/Makefile_insert (xml_libspxml_a_SOURCES): Add the new files.

	* src/xml/repr-private.h, src/xml/repr.cpp (sp_repr_nth_child):
	  Remove this unused function.

	* src/xml/repr.h, src/xml/repr.cpp (sp_repr_parent):
	  Mark pointer as not written through (const).

2004-05-18  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/xml/repr.cpp: Cleanup: greater conformance to CodingStyle.

	* src/Makefile_insert: Add missing dependencies on inkscape_version.h.
	* src/display/Makefile_insert: Adapt dependency object names for
	  `subdir-objects' automake option.
	* src/helper/Makefile_insert: Adapt dependency object names for
	  lack of libspchelp-specific CPPFLAGS.

2004-05-17  Carl Hetherington <inkscape@carlh.net>

	* src/libnrtype/nr-type-w32.cpp: Tentative fix for
	build problems on Win32.

	* src/extension/internal/svg.cpp: Coding style cleanups.

2004-05-17  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-item.h, src/sp-item.cpp: Remove unused
	  distance-conversion functions sp_item_distance_to_svg_bbox,
	  sp_item_distance_to_svg_viewport.

	* src/sp-item.cpp: Cleanup: greater conformance to CodingStyle.

	* acinclude.m4: Remove.

2004-05-16  Carl Hetherington  <inkscape@carlh.net>

	* src/extension/internal/svg.cpp:
	Throw an exception if sp_repr_save_file fails.  This should close
	bug 948921.

2004-05-16  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/check-header-compile.in: New script.
	* configure.in: Add it to list of files for substitution.

	* src/star-context.cpp: Minor cleanups, and use g_strdup_printf instead
	  of fixed-size buffer for translated string.

	* src/selection-chemistry.cpp: Use NR::Rect bounds() method instead of
	  old bounds(NRRect*).

	* src/document.cpp (sp_document_create): 
	* src/preferences-skeleton.h:
	  Use INKSCAPE_VERSION from inkscape_version.h instead of VERSION.

	* src/libnr/nr-rotate-test.cpp: Use new rotate_equalp function. 

	* src/libnr/nr-translate-ops.h (operator-): New function.

	* src/select-context.cpp:
	* src/selection-chemistry.cpp:
	* src/xml/repr.h:
	* src/sp-defs.h:
	  Cleanup: greater conformance to CodingStyle.

	* src/libnr/nr-macros.h: Don't #include nr-matrix.h, nr-rect.h.

	* src/arc-context.h, src/desktop-affine.h, src/dir-util.h,
	  src/draw-context.h, src/dyna-draw-context.h, src/help.h,
	  src/knotholder.h, src/prefs-utils.h, src/select-toolbar.h,
	  src/sp-clippath.h, src/sp-mask.h, src/sp-pattern.h, src/sp-use.h,
	  src/text-context.h, src/toolbox.h, src/tools-switch.h,
	  src/dialogs/dialog-events.h, src/dialogs/sp-attribute-widget.h,
	  src/display/sp-canvas.h, src/helper/gnome-utils.h,
	  src/helper/png-write.h, src/helper/stock-items.h, src/inkjar/jar.h,
	  src/libnr/nr-matrix.cpp, src/libnr/nr-point-l.h,
	  src/svg/stringstream.h, src/svg/svg-affine.cpp,
	  src/widgets/gradient-selector.h, src/widgets/paint-selector.h,
	  src/widgets/spinbutton-events.h, src/widgets/spw-utilities.h,
	  src/xml/repr-action.h:
	  Add missing header files as detected by check-header-compile script.

	* src/libnr/nr-rotate-fns.h, src/libnr/nr-rotate-fns.cpp: New files.
	* src/libnr/nr-rotate-fns-test.cpp: New unit test.
	* src/libnr/Makefile_insert, src/Makefile.am: Reference new files,
	  add to unit tests.

	* src/libnr/nr-rotate.h: Add Coord,Coord constructor.

	* src/libnr/nr-rotate.h, src/libnr/nr-rotate-ops.h (operator*=):
	New method.

	* src/libnr/nr-point-fns.h (point_equalp): New function.

	* src/radial.h: Remove this unused header.

	* src/xml/xml-forward.h: New file.
	* src/xml/Makefile_insert: Add it to xml_libspxml_a_SOURCES.
	* src/xml/repr-private.h: Include it.

2004-05-16  MenTaLguY  <mental@rydia.net>

	* src/libnrtype/nr-type-directory.cpp, src/libnrtype/nr-type-ft2.cpp,
	  src/libnrtype/nr-type-ft2.h, src/libnrtype/nr-type-gnome.h,
	  src/libnrtype/nr-type-w32.h, src/libnrtype/nr-type-xft.cpp,
	  src/libnrtype/nr-typeface.h:

	  transition to C++ inheritance

	* src/verbs.cpp, src/helper/action.h, src/helper/action.cpp,
	  src/widgets/button.cpp, src/libnr/nr-object.cpp, src/libnr/nr-object.h:
	  
	  removed barely-used "in-place construction" facility for NRObject

	* src/helper/action.h, src/helper/action.cpp,
	  src/display/nr-arena-glyphs.cpp, src/display/nr-arena-glyphs.h,
	  src/display/nr-arena-image.cpp, src/display/nr-arena-image.h,
	  src/display/nr-arena-item.cpp, src/display/nr-arena-shape.cpp,
	  src/helper/action.cpp, src/helper/action.h, src/libnr/nr-object.cpp,
	  src/libnr/nr-object.h, src/libnrtype/nr-type-ft2.cpp,
	  src/libnrtype/nr-type-gnome.cpp, src/libnrtype/nr-type-w32.cpp,
	  src/libnrtype/nr-typeface.cpp:

	  Made NRObject "C++-compatible".  All C++ features including virtual
	  methods and RTTI should now be available to NRObject subclasses 
	  _provided_:

	   a) there is an unbroken chain of _C++_ inheritance from the subclass
	      back to NRObject

	   b) the NRObject-derived inheritance chain is always first in cases
	      of multiple inheritance (the NRObject must be first in the memory
	      layout)

	   c) The subclass in question overrides NRObjectClass::cpp_ctor in its
	      own class_init function, with a pointer to a function that calls
	      the specific subclass' constructor (via placement new -- you will
	      need to #include <new> for this to work)

	      n.b. Objects of classes which do not override cpp_ctor will appear
	      to the C++ runtime system (RTTI and virtual dispatch, at least) as
	      objects of the closest ancestor class which does override it
	      (NRObject or NRActiveObject if nothing else).

2004-05-15  MenTaLguY  <mental@rydia.net>

	* src/display/nr-arena-shape.h, src/display/nr-arena-shape.cpp:
	  further reduced dependency on SPStyle

2004-05-14  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/libnr/nr-path.cpp, src/libnr/nr-path.h (nr_path_matrix_bbox_union):
	  Get rid of no-longer-needed tolerance arg.  Update callers.

	* src/selection.cpp, src/sp-chars.cpp, src/sp-image.cpp,
	  src/sp-item-group.cpp, src/sp-item.cpp, src/sp-item.h,
	  src/sp-marker.cpp, src/sp-root.cpp, src/sp-shape.cpp,
	  src/sp-symbol.cpp, src/sp-text.cpp, src/sp-typeset.cpp,
	  src/sp-use.cpp, src/dialogs/fill-style.cpp,
	  src/dialogs/stroke-style.cpp, src/display/nr-arena-shape.cpp,
	  src/libnr/nr-path.cpp, src/libnr/nr-path.h,
	  src/libnrtype/nr-font.cpp, src/libnrtype/nr-rasterfont.cpp,
	  src/libnrtype/nr-type-gnome.cpp, src/widgets/icon.cpp,
	  src/widgets/paint-selector.cpp:
	  Change argument from NRMatrix to NR::Matrix in SPItemClass->bbox,
	  sp_item_invoke_bbox, sp_item_invoke_bbox_full,
	  nr_path_matrix_bbox_union.  Users updated.

	* src/libnr/nr-rect.h, src/libnr/nr-rect.cpp (nr_rect_union_pt):
	  new function.

	* src/libnr/nr-matrix-fns.h, src/libnr/nr-matrix-fns.cpp
	  (NR::transform): new function.

	* src/Makefile_insert: Move fixes.cpp from libinkpre.a to libinkpost.a.
	* src/xml/Makefile_insert (xml_repr_action_test_LDADD):
	  Add libinkpost.a, for fixes.o.  `make check' now works again.

	* src/sp-text.cpp (sp_text_set_transform):
	  Don't include SP_OBJECT_CHILD_MODIFIED_FLAG in flags for
	  sp_object_request_update.  Addresses `critical' warning.

2004-05-13  John Cliff <simarilius@yahoo.com>

	* src/dialogs/stroke-style.cpp: Switched to using get_stock to retrieve markers.
	* src/helpers/stock-items.h, src/helpers/stock-items.cpp: created to handle stock items.
	* src/prefix.h: Added marker and gradient directorys.

2004-05-13  Kees Cook <kees@outflux.net>

	* configure.in, src/main.cpp, config.h.mingw, debian/rules:
	  made popt a requirement instead of an option.

2004-05-13  Carl Hetherington  <cth103@houllier.home>

	* sp-color-notebook.cpp: Fix uninitialised value spotted by valgrind.

	* stroke-style.cpp:
	Fix ink_extract_marker_name returning a pointer into a free()d buffer.

2004-05-13  Ted Gould <ted@gould.cx>

	* src/file.cpp:
	Making the default filename _("untitled.svg")

2004-05-12  Kees Cook <kees@outflux.net>

	* config.h.mingw: added g_ascii_strtod macro.

2004-05-12  Carl Hetherington <inkscape@carlh.net>

	* src/dialogs/export.cpp: fix faulty logic with exporting of
	selections, as reported by Artemio on the ML.

	* src/dialogs/desktop-properties.cpp: Fix a gtk_table size.
	Make use of spw_dropdown in one place.

	* src/select-context.cpp: Remove alt-drag "slow move" mode.
	Make alt-drag move without any grid snap, even if the grid
	is enabled.  Add a new mode, shift-drag, which preserves
	objects' grid offsets rather than snapping their snappoints.

	* src/selection-chemistry.cpp: Pasted objects have the same
	offset from the grid as the original, if the grid is enabled.
	Also a NRRect -> NR::Rect fix thrown in for no extra charge.

	* src/dialogs/display-settings.cpp: Added option to reverse
	the actions of drag and shift-drag when moving objects.

2004-05-12  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/main.cpp (main): Test ENABLE_NLS instead of HAVE_NLS (which
	wasn't getting defined).  Restores translations on *nix systems
	when inkscape translations aren't in system-wide /usr/share/locale.

2004-05-10  Carl Hetherington <inkscape@carlh.net>

	* src/sp-item.cpp, src/dialogs/display-settings.cpp: primitive
	support for preserving line widths when scaling.  Thanks to Bulia
	for telling me what to do :)
	* src/dialogs/align.cpp: refactor some cut-and-paste code into
	a separate function.  Remove NRRect.  Declaration-to-first-use
	cleanups.
	* src/dialogs/transformation.cpp, src/dialogs/fill-stype.cpp:
	NRRect removal.  Declaration-to-first-use cleanups.

2004-05-09  MenTaLguY <mental@rydia.net>

	* src/sp-paint-server.h: SPPaintServer now uses C++ inheritance

	  (bigger question -- should SPPaintServer derive from SPObject?  I think
	   not, actually ... it's more something that should be aggregated into
	   the various paint-server-capable types)

	* src/display/nr-arena-shape.h, src/display/nr-arena-shape.cpp:
	  first steps in removing SPStyle dependency from NRArenaShape --
	  add fill and stroke paint server members, and use those instead
	  of reading directly from an SPStyle.

2004-05-09  Kees Cook <kees@outflux.net>

	* src/libnrtype/nr-type-xft.cpp: added patch 898200, hopefully this
	  won't break anyone.
	* src/dialogs/desktop-properties.cpp: added patch 947127, along with
	  some orientation bugfixes, list cleanup, and logic to select the
	  correct menu items based on document settings.
	* configure.in: default to always replace g_ascii_strtod.

2004-05-08  Kees Cook <kees@outflux.net>

	* src/extension/internal/gdkpixbuf-input.cpp: skip SVG files. (open bug)
	* configure.in, src/Makefile_insert, src/fixes.cpp: added replacement
	  for g_ascii_strtod, since it has locale-related bugs in gnome 2.0.
	  The upstream version is fixed, so some day, we won't need this any
	  more.  (fixes "ugly icons" bug, and possibly the spinbutton locale bug)
	* src/dyna-draw-context.cpp, src/rect-context.cpp, src/sp-namedview.cpp,
	  src/sp-object.cpp, src/sp-object.h, src/sp-pattern.cpp,
	  src/sp-polygon.cpp, src/sp-polyline.cpp, src/sp-root.cpp,
	  src/sp-spiral.cpp, src/sp-star.cpp, src/sp-symbol.cpp,
	  src/sp-text.cpp, src/spiral-context.cpp, src/star-context.cpp,
	  src/svg/ftos.cpp, src/svg/svg-affine.cpp, src/svg/svg-color.cpp,
	  src/svg/svg-length.cpp: adding "config.h", making a few extra
	  locale-sensitive functions use g_ascii versions.

2004-05-08  MenTaLguY <mental@rydia.net>

	* src/sp-item.cpp: move "transformed" signal emission after actual
	  application of transform

	* src/xml/repr-action.cpp, src/xml/repr-action.h, src/xml/repr.cpp:
	  fix lifecycle issues with content and attribute strings

	* src/sp-object.h, src/sp-object.cpp: added SPObject::setId()

2004-05-08  Kees Cook <kees@outflux.net>

	* src/verbs.cpp, src/help.cpp: localizing "about" and "keys" stuff.
	* po/*.po: rebuilt for new strings.

2004-05-08  Carl Hetherington <inkscape@carlh.net>

	* src/dialogs/desktop-properties.cpp: the usual cleanups.  Also
	add some sp_document_done()s in various places.

2004-05-08  bulia byak <bulia@users.sourceforge.net>

	* widgets/paint-selector.cpp: Tooltips, slight cosmetics

	* main.cpp: --help edit 

	*  sp-use.h sp-use.cpp: Redid move compensation using _transformed_signal

	* sp-item.h sp-item.cpp: Added _transformed_signal, emitted by write_transform,
	passes the difference transform relative to the old one (not the new transform
	set)

	* nodepath.cpp: Fix lagging update of the other handle for smooth nodes 

	* widgets/dash-selector.cpp: (Almost) fixed display of shorter-than-0.5 dashes
	in selector; proper fixing will require manual drawing the dashes instead of
	using gdk dashes

	* preferences-skeleton.h: lots of new  dasharrays 

	* dialogs/stroke-style.cpp: Remove repetitive code; relocation patch from
	mhearn; fixed, reenabled, and automated marker previews (no need for previews
	in markers.svg)

	* share/markers/markers.svg: Cleanup, sizes, remove manual previews 

	* style.cpp: Disabled warning for overflow property (we need it for markers)

	* splivarot.cpp: Fixed transform when doing boolop inside group 

	* libnr/nr-path.cpp: Ported fix from sodi, fixes two bugs with endnodes of a
	curve on the same hor/vert line

	* sp-namedview.cpp: Use set_default_size instead of _resize for setting window
	from namedview

	* preferences-skeleton.h dialogs/item-properties.cpp: Objects props
	transientized (better late than never)

	* dialogs/display-settings.cpp: Added simplify threshold

	* sp-use.cpp: Mega-kill use on unlink

	* preferences-skeleton.h dialogs/display-settings.cpp: Orphaned clones options

	* sp-item-group.cpp: Prevent jumps when ungrouping clone with its original

	* sp-object.cpp: Fix crash when deleting clone and its original

	* toolbox.cpp, tool contexts: Alt-x and top panel keyboard shortcuts now work
	for all tools

	* sp-use.cpp enums.h: Unlink option on self-delete

	* sp-use.cpp: Fix: disappeating clone on undoing ungrouping (_show finally works properly)

	* splivarot.cpp: Boolops: cleanup, preserve id, parent, position, fix to take
	style from the bottom object

	* interface.cpp verbs.cpp shortcuts.cpp: Mnemonics, tooltips, shortcuts,
	cleanup, autoraise removed from menu

2004-05-07  Kees Cook <kees@outflux.net>

	* src/verbs.cpp: re-localizing tutorials.  My goof!
	* po/POTFILES.in: removed arikkei references

2004-05-07  Carl Hetherington <inkscape@carlh.net>

	* src/desktop.cpp: make sure that a SPNamedView's modified signal
	is connected to the SPDesktop even when a file is loaded into an
	existing SPDesktop.  Fixes problems whereby grid snap does not
	work for the first file loaded in a session.  Fix a && -> & typo.

	* src/sp-object.cpp: declaration-to-first-use and coding style
	cleanups.

2004-05-05 Spundun Bhatt <spundun@isi.edu>

	* configure.in: Stole Nathan's configure hack and used it to 
	support gtkmm-2.4

2004-05-06  Ted Gould  <ted@gould.cx>

	* src/file.cpp, src/extension/extension.cpp, src/extension/init.cpp,
	src/extension/internal/Makefile_insert,
	src/extension/internal/gdkpixbuf-input.cpp,
	src/extension/internal/gdkpixbuf-input.h:
	  Changing the import functionality so that it works much more like open.
	  You can use any format, and it will place that file directly in the
	  document that you are working on.  Added input extensions that cover all
	  of the bitmap formats that are covered with gdkpixbuf.  Also, more
	  formats can be used using the scripting system.

2004-05-06  Carl Hetherington <inkscape@carlh.net>

	* src/sp-line.cpp, src/sp-mask.cpp, src/sp-metrics.cpp:
	declaration-to-first-use and coding style cleanups

2004-05-05  MenTaLguY  <mental@rydia.net>

	* src/libnrtype/nr-type-dictionary.cpp: removed 'private-fonts'
	  feature (we should rely on fontconfig for "custom" font stuff)

	* configure.in, src/Makefile_include, src/Makefile.am,
	  src/libarikkei/*: removed the now unused libarikkei

2004-05-05 Nathan Hurst <njh@mail.csse.monash.edu.au>

	* src/dialogs/text-edit.cpp, configure.in: Added support for spell
	checking in text dialog.
	
2004-05-04  MenTaLguY <mental@rydia.net>

	* src/display/nr-arena-glyphs.h: fixed cut-and-paste error in
	  NRArenaGlyphsGroup::create()

	* src/selection.cpp, src/selection.h: fixed global "changed" propagation

2004-05-02  MenTaLguY <mental@rydia.net>

	* src/file.cpp, src/print.cpp, src/sp-chars.cpp, src/sp-clippath.cpp,
	  src/sp-image.cpp, src/sp-item-group.cpp, src/sp-mask.cpp,
	  src/sp-pattern.cpp, src/sp-shape.cpp, src/sp-text.cpp,
	  src/sp-use.cpp, src/dialogs/stroke-style.cpp,
	  src/display/canvas-arena.cpp, src/display/nr-arena-glyphs.cpp,
	  src/display/nr-arena-glyphs.h, src/display/nr-arena-group.h,
	  src/display/nr-arena-image.h, src/display/nr-arena-item.cpp,
	  src/display/nr-arena-item.h, src/display/nr-arena-shape.h,
	  src/display/nr-arena.h, src/libnr/nr-object.h, src/widgets/icon.cpp:

	  removed nr_arena_item_new in favor of static ::create() functions
	  which call NRArenaItem::init() to perform setup (i.e. setting
	  NRArenaItem::arena).  Eventually NRArenaItem::init() and
	  nr_arena_item_init will merge and become NRArenaItem's constructor.

2004-04-30  MenTaLguY <mental@rydia.net>

	* src/sp-use.cpp: call parent class' write methods rather than
	  attempting to do everything (wrongly) ourselves; among other
	  things, <use> transform attributes weren't getting written

	* src/sp-object.h, src/sp-object.cpp:

	  designate a "successor" object so we still perform as
	  expected if objects are replaced in the middle of e.g. a 
	  bulk delete operation

	* src/sp-use.cpp: cleanups and succession logic for <use>
	  deletion

	* src/widgets/sp-hwrap-box.cpp, src/widgets/sp-hwrap-box.h,
	  src/widgets/sp-vwrap-box.cpp, src/widgets/sp-vwrap-box.h,
	  src/widgets/sp-wrap-box.cpp, src/widgets/sp-wrap-box.h,
	  src/widgets/test-wrapbox.cpp, src/widgets/Makefile_insert:

	  Removed unused (and imperfect) "wrapbox" widgets.

	* src/sp-object.h, src/sp-object.cpp, src/sp-item-group.cpp:

	  Removed unused sp_object_invoke_forall and sp_object_sequence
	  methods.  (forall might be nice to have, but we can do better
	  implementation-wise now that we're in C++-land)

2004-04-30 njh <njh@mail.csse.monash.edu.au>

	* main.cpp: replaced gtk_init with g_type_init for console mode.
	Closes 944969.
	
2004-04-29  MenTaLguY <mental@rydia.net>

	* src/sp-image.cpp, src/sp-item.cpp, src/sp-item.h, src/sp-line.cpp,
	  src/sp-path.cpp, src/sp-rect.cpp, src/sp-text.cpp:

	  write_transform becomes set_transform, which applies the given
	  transform to the object without (!) invoking a repr write

	* src/sp-star.cpp, src/svg/svg-length.h, src/svg/svg-length.cpp,
	  src/svg-types.h, src/svg/svg.h:

	  replaced raw integers with real units enum

	* src/libnr/nr-matrix.h:

	  removed dead assertion (it's always valid to retrieve the
	  translation component of a matrix)

	* src/selection-chemistry.cpp:

	  delete items via SPItem (SPObject), not repr

	* src/sp-object.h, src/sp-object.cpp:

	  added SPObject::deleteObject() and a delete notification signal;
	  SPObject now inherits from GObject in the C++ sense

	* src/sp-use.h:

	  don't accept references to the use or its ancestors (preventing
	  infinite loops)

	* src/sp-use.cpp, src/sp-use.h:

	  added automatic deletion when referrent is deleted

	* src/uri-reference.h:

	  added URIReference::getOwner()

2004-04-29  Carl Hetherington <inkscape@carlh.net>

	* src/extension/internal/win32.cpp: add textToPath parameter to
	description in order to fix #944131.

2004-04-28  Carl Hetherington <inkscape@carlh.net>

	* src/desktop.cpp, src/inkscape.cpp, src/sp-namedview.cpp
	Part of the fix for #942149.  Also fixed some compiler warnings.

	* src/display/nr-arena.cpp: Fixed an unused variable warning.

	* src/main.cpp: Fix a warning that is raised on Windows.

2004-04-28  bulia byak <bulia@users.sourceforge.net>

	* inkscape.cpp: Fixed prev/next desktop; numbered from 0 

	* Lots of files: Replaced all strtod() and atof() by g_ascii_strtod() 

	* interface.cpp verbs.cpp: Tooltip edits 

	* view.cpp view.h desktop.cpp: Signal and function to pop statusbar message

	* dialogs/dialog-events.cpp: Only set the UTILITY hint for non-modal windows,
	fixes "disappearing save as"

	* toolbox.cpp widgets/widget-sizes.h widgets/button.cpp: Got rid of button
	relief, top panel made less tall

	* desktop.cpp preferences-skeleton.h dialogs/display-settings.cpp: Done away
	with the sticky zoom button, now in prefs

	* path-chemistry.cpp: Preserve id= in combine/break, convert to paths; preserve
	z-order in combine/break; cleanups

	* splivarot.cpp: New selection API, Simplify preserves id= 

	* select-context.cpp preferences-skeleton.h sp-item.cpp display-settings.cpp
	splivarot.cpp sp-item-group.cpp sp-item-transform.cpp
	sp-item-notify-moveto.cpp nodepath.cpp node-context.cpp seltrans.cpp
	seltrans.h: Switched to global preservetransform, transform writing
	unification (no more manual transform= setting all over the place), stamp
	preserves parent, mental's new SPSelection API, pruning dead code

	* verbs.cpp interface.cpp: Eliminated Dialogs menu, added ... to dialog
	commands, rearrangements, menu items display tooltips in statusbar when
	selected

	* sp-item-group.cpp sp-item-group.h: Made document_done optional in ungroup (not
	done when the function is called from another function)

	* dialogs/display-settings.cpp enums.h preferences-skeleton.h sp-use.cpp
	sp-use.h: Clone move compensation (3 modes), settable in prefs

	* seltrans.cpp selection-chemistry.cpp: Do not translate a clone if its original
	is in the selection

	* verbs.cpp verbs.h interface.cpp shortcuts.cpp sp-use.cpp sp-use.h
	selection-chemistry.cpp selection-chemistry.h: Unlink Clone verb and menu
	command (preserves id=)

	* selection-chemistry.cpp selection-chemistry.h verbs.h verbs.cpp shortcuts.cpp
	interface.cpp: Select Original verb and command, scrolls to the original

	* selection-chemistry.cpp selection-chemistry.h verbs.cpp verbs.h interface.cpp:
	Clone command

	* sp-use.h sp-use.cpp: Use URIReference; Propagate update to parent class
	(SPItem) (fixes redraw on dragging a clone)

	* dropper-context.cpp dropper-context.h dialogs/display-settings.cpp:
	Implemented pick modes (pick either actual color with transparency or visible
	color without transparency); added statusbar indication; color is only set on
	mouse release

	* seltrans.cpp display/sodipodi-ctrlrect.cpp: Finally the correct selection cue
	rect (fixed displacement)

2004-04-27  Carl Hetherington <inkscape@carlh.net>

	* src/desktop.cpp: Check for there being no items when zooming to
	the drawing.  This fixes bug #942137.

2004-04-26  Carl Hetherington <inkscape@carlh.net>

	* config.h.mingw, prefix.h:
	INKSCAPE_VERSION moved to inkscape_version.h.
	INKSCAPE_{PIXMAP,SCREENS,TUTORIALS,MARKERS}DIR moved to prefix.h

	* src/Makefile.mingw, src/inkscape_version.h.mingw
	Use CVS inkscape_version.h.mingw for inkscape_version.h on Win32.

	* src/sp-use.cpp: fix a warning.

2004-04-26  Ted Gould  <ted@gould.cx>

	* share/extensions/ai_input.inkmod, share/extensions/dia.inkmod,
	share/extensions/txt2svg.inkmod, src/extension/extension.cpp,
	src/extension/internal/svg.cpp:

	Making the names of the input extensions look like the output ones.
	Also, threw in a slight memory savings in removing the implementation on
	deactivated extensions.

2004-04-26  MenTaLguY  <mental@rydia.net>

	* src/selection.cpp: migrate to new glib idle API

	* src/extension/db.cpp: can't call ->deactivated() on a NULL pointer..

2004-04-26  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* configure.in: Replace use of old AM_PROG_LIBTOOL macro with
	  AC_PROG_LIBTOOL.

2004-04-26  Ted Gould  <ted@gould.cx>

	* share/extensions/epsi_output.inkmod:

	Added in a check for ps2epsi

	* src/dialogs/filedialog.cpp, src/extension/db.cpp, src/extension/db.h,
	src/extension/extension.cpp, src/extension/extension.h,
	src/extension/init.cpp, src/extension/system.cpp:

	Implementing a 'deactivated' extension.  This means that it should
	still exist, but show up as insensitive in any GUI element that could use
	it.  The idea here is that users should know what they don't have, but
	Inkscape supports.

2004-04-26 Nathan Hurst <njh@mail.csse.monash.edu.au>

	* src/{libnr,libnrtype,widgets,display,helper,.}*.{h,cpp}: moved
	from typedef _name name; to C++ style struct name; forward
	references.
	
2004-04-25  Ted Gould  <ted@gould.cx>

	* share/extensions/ai_output.inkmod, share/extensions/dia.inkmod,
	share/extensions/dropshadow.inkmod, share/extensions/epsi_output.inkmod,
	share/extensions/roundhole.inkmod, share/extensions/svgz_input.inkmod,
	share/extensions/svgz_output.inkmod, share/extensions/txt2svg.inkmod,
	src/extension/implementation/script.cpp,
	src/extension/implementation/script.h:

	Adding in support for superior checking of dependencies.  Now scripts
	can include a line, which will look for a binary in the path.  So
	something like dia input will no be loaded if there isn't dia available in
	the path.

2004-04-25  Carl Hetherington <inkscape@carlh.net>

	* src/verbs.cpp, src/rect-context.cpp, src/spiral-context.cpp,
	src/event-context.cpp, src/text-context.cpp,
	src/dialogs/stroke-style.cpp, src/xml-tree.cpp, src/widgets/sp-widget.cpp:
	SPSelection OO-ification.

	* src/display/curve.cpp: Don't raise a critical error if a new
	curve cannot be created in sp_curve_new_from_bpath().  This can
	happen if a file contains a strange path, like one with only a
	move in it and nothing else.  This is part of the fix for bug
	934882.

	* src/sp-path.cpp: cope with sp_curve_new_from_bpath() returning
	NULL in sp_path_set().  This is the other part of the fix for 934882.

	* src/path-chemistry.cpp, src/sp-offset.cpp, src/sp-ellipse.cpp,
	src/display/nr-arena-glyhs.cpp:
	added asserts for calls to sp_curve_new_from_bpath() which look
	like they might not expect it to return NULL.

	* src/desktop.h: add a comment about how SPDesktop::selection
	should never generally be NULL.

	* src/desktop-handles.cpp: ensure that sp_desktop_selection never
	returns NULL, so that we don't have to check for this eventuality
	elsewhere.

	* src/arc-context.cpp, src/seltrans.cpp, src/desktop.cpp: be less defensive about
	SPDesktop::selection being NULL.

	* src/path-chemistry.cpp, src/select-context.cpp,
	src/selection-chemistry.cpp, src/star-context.cpp,
	src/dialogs/align.cpp, src/dialogs/item-properties.cpp, src/dialogs/text-edit.cpp:
	SPSelection OO-ification.  Also some coding style and
	declaration-to-first-use cleanups.

	* src/toolbox.cpp: SPSelection OO-ification.  Various cleanups.

	* src/selection.h: remove deprecated access functions.

	* src/dialogs/fill-style.cpp: declaration-to-first-use cleanups.

	* src/selection.cpp: add vim and Emacs mode blocks.

	* src/object-ui.cpp: very minor coding style fix.
	
2004-04-24  MenTaLguY <mental@rydia.net>

	* src/arc-context.cpp, src/dyna-draw-context.cpp, src/object-ui.cpp,
	  src/path-chemistry.cpp, src/rect-context.cpp, src/select-context.cpp,
	  src/select-toolbar.cpp, src/selection-chemistry.cpp, src/selection.h,
	  src/spiral-context.cpp, src/star-context.cpp, src/text-context.cpp,
	  src/verbs.cpp, src/dialogs/export.cpp, src/dialogs/fill-style.cpp,
	  src/dialogs/in-dt-coordsys.cpp, src/dialogs/stroke-style.cpp,
	  src/dialogs/transformation.cpp, src/dialogs/xml-tree.cpp:

	  removed sp_selection_set_item(), sp_selection_set_repr(),
	  sp_selection_is_empty(), sp_selection_item_selected(),
	  and sp_selection_repr_selected()

2004-04-24  Ted Gould  <ted@gould.cx>

	* share/extensions/ill2svg.pl:

	Applying a patch made to the Sodipodi list by Tuukka Pasanen which adds in
	support for text in Illustrator files.  Also, I backed out the changes
	which removed being able to specify the line endings.  This will, by
	default, force them back to mac compatible.  Mac files didn't work with
	those changes.

2004-04-24  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* configure.in: Tentatively remove config.h definitions of
	  INKSCAPE_MARKERSDIR, INKSCAPE_PIXMAPDIR, INKSCAPE_SCREENSDIR,
	  INKSCAPE_TUTORIALSDIR, with the understanding that these are to be
	  provided by prefix.h.
	* src/prefix.h: Define INKSCAPE_MARKERSDIR.

	* src/extension/extension.cpp (Extension):
	* src/extension/init.cpp (check_extensions): 
	  Address warning.

	* src/dialogs/stroke-style.cpp: #include prefix.h.

	* src/Makefile.am (EXTRA_DIST): Add */makefile.in.

	* src/libnr/Makefile_insert (libnr_libnr_a_SOURCES):
	  Add libnr/nr-convex-hull.h, needed by sp-canvas.cpp.

2004-04-24  Ted Gould  <ted@gould.cx>

	* src/Makefile_include, src/prefix.cpp:

	Removing the redefition of NULL and adding to the make system.

2004-04-24  Ted Gould  <ted@gould.cx>

	* src/extension/db.cpp, src/extension/db.h, src/extension/extension.cpp,
	src/extension/extension.h, src/extension/init.cpp,
	src/extension/internal/eps-out.cpp, src/extension/internal/eps-out.h,
	src/extension/internal/ps-out.cpp, src/extension/internal/ps-out.h:

	Adding in more checks for individual extensions.  All of them
	should still pass though.  Also, moved the extension database from
	glib to STL.  This allows extensions to be deleted while using the
	foreach functions (which causes instability with the glib hash
	table).

2004-04-24  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/dialogs/Makefile_insert:
	* src/display/Makefile_insert:
	* src/xml/Makefile_insert:
	  Get rid of unneeded CPPFLAGS specification.

	* src/Makefile.am:
	* src/Makefile_insert:
	  New generated file inkscape_version.h, to replace
	  -DINKSCAPE_VERSION=\"$(VERSION)\".
	* src/help.cpp: #include it.

2004-04-23  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/sp-polygon.cpp:
	* src/splivarot.cpp:
	* src/style.cpp:
	Change include stringstream.h to include svg/stringstream.h.

	* src/Makefile.am, src/Makefile_insert: Change libinkscape.a use
	  to eliminate triple compilation of these object files.

	* src/Makefile.am: Use `subdir-objects' option.

	* src/Makefile.am: Add global INCLUDES setting.
	* src/*/Makefile_insert: Get rid of now-redundant $(INKSCAPE_CFLAGS)
	  from *_CPPFLAGS.

	* src/*/makefile.in: `%' as a target doesn't behave as intended,
	so replace with less general `clean %.a %.o' and add .SUFFIXES.

2004-04-22  Ted Gould  <ted@gould.cx>

	* src/draw-context.cpp, src/dropper-context.cpp,
	src/dyna-draw-context.cpp, src/node-context.cpp, src/nodepath.cpp,
	src/sp-ellipse.cpp, src/sp-offset.cpp, src/sp-path.cpp,
	src/sp-polygon.cpp, src/sp-shape.cpp, src/splivarot.cpp, src/toolbox.cpp,
	src/display/curve.cpp, src/display/nr-arena-shape.cpp,
	src/extension/internal/gnome.cpp, src/extension/internal/ps.cpp,
	src/libnr/nr-path.cpp, src/libnr/nr-path.h,
	src/libnrtype/nr-rasterfont.cpp, src/libnrtype/nr-type-ft2.cpp,
	src/libnrtype/nr-type-gnome.cpp, src/libnrtype/nr-type-w32.cpp,
	src/libnrtype/nr-typeface.cpp, src/livarot/PathCutting.cpp,
	src/svg/gnome-canvas-bpath-util.cpp, src/svg/svg-path.cpp:

	Changing the ART_ enums to NR_ so that if libart is include (like if
	you are building gnome-print) it doesn't conflict with the internal
	definitions.

	* share/extensions/svgz_output.inkmod, src/extension/extension.cpp,
	src/extension/init.cpp, src/extension/implementation/script.cpp:

	Adding in a little more checking code.  Now extensions can start
	deleting themseleves if they fail certain tests.  More tests are
	needed, along with more testing of this feature.  Consider this
	an 'early release' of the feature. ;)

2004-04-22  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/Makefile.am: Make non-recursive.  Now sources */Makefile_insert.
	  See HACKING or discussion on mailing list.
	* autogen.sh: Bump requirement from automake-1.6 to automake-1.7.
	* configure.in: Don't generate src/blah/Makefile, but do generate
	  src/blah/makefile.
	* src/*/Makefile.am: Remove.
	* src/*/makefile.in: New wrapper makefiles to allow typing `make' from
	  subdirectories of src.  (Not used by compiles started from top-level
	  or from src/.)

2004-04-21  MenTaLguY <mental@rydia.net>

	* src/libnrtype/nr-type-w32.h: fixed unremoved underscores

	* src/select-context.cpp, src/selection.cpp, src/selection.h,
	  src/seltrans.cpp, src/tools-switch.cpp, src/dialogs/align.cpp:
	  remove improper twiddling of desktop message line from SPSelection;
	  some additional work is now required in SPSelectContext to update
	  the message properly in all cases.

	* src/selection.h, src/selection.cpp: touched up and documented
	  SPSelection

	* src/uri-references.h: documentation touch-ups

2004-04-20  Kees Cook <kees@outflux.net>

	* src/file.cpp, src/desktop.cpp: moved sp_file_open unselection code into
	  sp_desktop_change_document.  Generalized Carl's fix for unref counting
	  since it applies in both cases.  (My bad!)

2004-04-20  MenTaLguY <mental@rydia.net>

	* src/text-context.cpp: merged Carl's fix for signal cleanup

	* src/selection.h: marked wrappers for old API as deprecated

2004-04-20  Carl Hetherington <inkscape@carlh.net>

	* src/extension/internal/ps.cpp, src/extension/internal/ps.h:
	Fixed some bugs in exporting images that seem to have been
	introduced when the code was copied from the gimp.  They caused
	problems when exporting bitmap images to PS.

	* src/file.cpp: fix bug whereby the first file loaded in a session
	would not have its modified status checked when closed.  Hence if
	you modified the first file you loaded and then closed it, you
	would not be asked to confirm the close.

	* src/preferences-skeleton.h: add \n to the end of each line to
	fix bug 938368.

2004-04-19  MenTaLguY <mental@rydia.net>

	* src/arc-context.cpp, src/desktop-handles.h, src/desktop.h,
	  src/draw-context.cpp, src/draw-context.h, src/forward.h,
	  src/inkscape-private.h, src/inkscape.cpp, src/node-context.cpp,
	  src/node-context.h, src/rect-context.cpp, src/selection-chemistry.cpp,
	  src/selection-chemistry.h, src/selection.cpp, src/selection.h,
	  src/seltrans.h, src/spiral-context.cpp, src/star-context.cpp,
	  src/star-context.h, src/text-context.cpp, src/dialogs/xml-tree.cpp,
	  src/widgets/sp-widget.h:

	  finished GObject removal from SPSelection

	* src/arc-context.h, src/arc-context.cpp, src/desktop.cpp, src/desktop.h,
	  src/draw-context.cpp, src/draw-context.h, src/node-context.cpp,
	  src/node-context.h, src/rect-context.cpp, src/rect-context.h,
	  src/selection.cpp, src/selection.h, src/seltrans.cpp, src/seltrans.h,
	  src/spiral-context.cpp, src/spiral-context.h, src/text-context.cpp,
	  src/text-context.h, src/toolbox.cpp:

	  migrated SPSelection to SigC++ signals (though it's a bit messy
	  right now)

2004-04-19  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/dialogs/stroke-style.cpp: Cleanups: greater conformance to
	CodingStyle.  Moved some declarations to their first use.

2004-04-19  Carl Hetherington <inkscape@carlh.net>

	* src/dialogs/stroke-style.cpp, libnr/nr-rect-l.cpp:
	Fix a couple of compiler warnings.

	* src/dialogs/filedialog-win32.cpp: add OFN_NOCHANGEDIR to Win32
	flags in OPENFILENAME structs.  This prevents the open / save
	boxes from changing the current directory.  Any change to the
	current directory causes problems for subsequent attempts to
	load icons from pixmaps.  Also, fix a bug whereby the save
	dialogue would sometimes not open due to being passed a filename
	it didn't like.

2004-04-19  bulia byak <bulia@users.sourceforge.net>

	* shortcuts.cpp selection-chemistry.cpp selection-chemistry.h verbs.cpp verbs.h
	interface.cpp: Clone command (Edit menu, Shift+Ctrl+N)

	* sp-use.cpp: Update propagated to parent class (SPItem), misc fixes

	* sp-polygon.cpp: Fix for points= updating by adding set_shape call into _write
	(bug 910142)

	* text-context.cpp: Do not create text object unless a printable key was
	pressed; fixes 934280

	* widgets/dash-selector.cpp dialogs/stroke-style.cpp: Removed marker buttons,
	fixed g_free crash in marker menus, added tooltips, added stroke-miterlimit
	spinbutton

	* splivarot.cpp: Outline handles multiple objects; All commands use correct
	stroke_miterlimit

	* splivarot.cpp sp-offset.cpp: Fix for 932642 

	* helper/sodipodi-ctrlrect.cpp: Simplify and fix dashes and offsets

	* widgets/gradient-selector.cpp: Tooltip edits 

	* verbs.cpp verbs.cpp verbs.h interface.cpp...: Remove tool options

	* seltrans.cpp: Pivot marker made inverse

	* toolbox.cpp: More defocusing

	* *-context.cpp: Eliminated config widgets from all tools 

	* toolbox.cpp sp-ellipse.cpp: Ellipse fixes, tooltips

	* verbs.cpp: Options -> Preferences

	* dialogs/display-settings.cpp: An options dialog, completely new; selector
	widget grafted here

	* preferences-skeleton.h node-context.cpp select-context.cpp: scaling uses
	defaultscale

	* dialogs/display-settings.cpp display/nr-arena-image.cpp: Make oversample
	saveable

	* toolbox.cpp: Aux toolbar for calligraphic

	* preferences-skeleton.h: fill-opacity:1 for calligraphic 

	* select-context.cpp seltrans.cpp seltrans.cpp: Patch to enable box and none
	options for per-object selection cue

	* main.cpp: Removed C-locale setting, not needed anymore; temporary switch of
	gettext encoding for console output

	* inkscape.cpp: Memory fix from sodi

	* right-click finishes pen (patch by Carl)  draw-context.cpp

2004-04-19  Carl Hetherington <inkscape@carlh.net>

	* src/livarot/ShapeRaster.cpp
	Fix an unitialised value error that was spotted by valgrind.

2004-04-18  MenTaLguY <mental@rydia.net>

	* src/selection.cpp, src/selection.h, src/selection-chemistry.cpp,
	  src/seltrans.cpp, src/nodepath.cpp:
	  made all SPSelection members private, and changed all methods into
	  real C++ methods (with temporary inline wrappers for the old C
	  pseudo-methods)

2004-04-18  Carl Hetherington <inkscape@carlh.net>

	* src/print.cpp, src/print.h, src/sp-text.cpp
	src/extension/extension.cpp src/extension/extension.h,
	src/extension/implementation/implementation.cpp,
	src/extension/implementation/implementation.h,
	src/extension/internal/eps-out.cpp, src/extension/internal/eps-out.h,
	src/extension/internal/ps.cpp, src/extension/internal/ps.h,
	Add very basic feature to allow PS text to be exported as real
	text, rather than being converted to paths first.  Needs some
	work, mostly on font handling.

	* src/seltrans.cpp: Slightly improve placement of the bounding
	box selection cue.
	
	* src/sp-shape.cpp: various marker-related cleanups, mostly factoring out
	common code into functions.
	
2004-04-17  MenTaLguY <mental@rydia.net>
	* src/inkscape.cpp, src/node-context.cpp, src/selection-chemistry.cpp,
	  src/selection.cpp, src/selection.h, src/seltrans.cpp, src/sp-gradient.cpp,
	  src/sp-item.cpp, src/sp-offset.cpp, src/dialogs/transformation.cpp,
	  src/libnr/nr-rect.cpp, src/libnr/nr-rect.h:
	  Cleaned up NR::Rect API and made SPSelection's desktop pointer private.

	* src/display/sp-canvas.cpp, src/libnr/nr-convex-hull.h,
	  src/libnr/nr-rect.h: 

	  First use of NR::ConvexHull (for propagating canvas bounding boxes)

2004-04-17  Kees Cook <kees@outflux.net>

	* share/icons/icons.svg, src/verbs.cpp: made last three ugly menu icons.

2004-04-17  Nathan Hurst <njh@mail.csse.monash.edu.au>

	* configure.in src/draw-context.cpp src/dropper-context.cpp
	src/dyna-draw-context.cpp src/nodepath.cpp src/nodepath.h
	src/path-chemistry.cpp src/sp-chars.cpp src/sp-ellipse.cpp
	src/sp-offset.cpp src/sp-path.cpp src/sp-polygon.cpp
	src/sp-shape.cpp src/sp-text.cpp src/splivarot.cpp src/style.cpp
	src/style.h src/dialogs/fill-style.cpp
	src/dialogs/object-properties.cpp src/dialogs/stroke-style.cpp
	src/display/canvas-bpath.cpp src/display/canvas-bpath.h
	src/display/canvas-grid.h src/display/curve.cpp
	src/display/curve.h src/display/nr-arena-glyphs.cpp
	src/display/nr-arena-glyphs.h src/display/nr-arena-shape.cpp
	src/display/sodipodi-ctrl.cpp src/display/sodipodi-ctrl.h
	src/display/sodipodi-ctrlrect.h src/display/sp-canvas-util.cpp
	src/display/sp-canvas-util.h src/display/sp-canvas.cpp
	src/display/sp-canvas.h src/display/sp-ctrlline.cpp
	src/extension/internal/ps.cpp src/extension/internal/ps.h
	src/libnr/Makefile.am src/libnr/libnr.def src/libnr/nr-path.cpp
	src/libnr/nr-path.h src/libnr/nr-svp-private.h
	src/libnr/nr-svp-render.cpp src/libnr/nr-svp-render.h
	src/libnr/nr-svp.cpp src/libnr/nr-svp.h
	src/libnrtype/nr-rasterfont.cpp src/libnrtype/nr-type-ft2.cpp
	src/libnrtype/nr-type-gnome.cpp src/libnrtype/nr-type-w32.cpp
	src/libnrtype/nr-typeface.cpp src/livarot/PathCutting.cpp
	src/svg/gnome-canvas-bpath-util.cpp
	src/svg/gnome-canvas-bpath-util.h src/svg/svg-path.cpp
	src/svg/svg.h: removed libart.

	* src/libnr/nr-svp-uncross.cpp src/libnr/nr-svp-uncross.h: deleted
	uncross and SVL routines.


2004-04-15  Carl Hetherington <inkscape@carlh.net>

	* src/make.exclude, src/make.dep, src/make.files, src/make.ofiles:
	Various fixes to the Win32 build following rearrangement of some
	source files and cleanups to libnr.

	* src/sp-text.cpp: remove an unused variable.

	* src/display/sodipodi-ctrlrect.cpp: removed two unused variables.

2004-04-16  MenTaLguY <mental@rydia.net>

	* src/selection.cpp, src/selection.h, src/forward.h: initial
	  C++ification of SPSelection class

2004-04-15  Kees Cook <kees@outflux.net>

	* debian/control, debian/changes: dropping (currently) unused
	  dependancies.  Added "0.39cvs" tag.

2004-04-15  Carl Hetherington <inkscape@carlh.net>

	* src/seltrans.cpp, src/helper/sodipodi-ctrlrect.cpp,
	src/helper/sodipodi-ctrlrect.h:
	  Use black, dashed bounding boxes for indicating itemselection,
	  rather than red, solid boxes (as suggested by Bulia).

	* src/desktop.cpp:
	Small fix for the problem whereby the first file loaded in an
	Inkscape session will not have its grid set up properly.  This was
	my patch #935013.

	* src/dialogs/filedialog-win32.cpp:
	Use the extension system to build the list of allowable file types
	for save.  This means that save as PS and EPS work properly.

	* src/streams-zlib.cpp, src/livarot/PathConversion.cpp,
	src/livarot/PathCutting.cpp, src/livarot/PathSimplify.cpp,
	src/livarot/PathStroke.cpp, src/livarot/Shape.cpp,
	src/livarot/ShapeMisc.cpp, src/display/nr-arena-glyphs.cpp,
	src/helper/sodipodi-ctrlrect.cpp, src/helper/sp-canvas.cpp,
	src/extension/internal/win32.cpp:
	Fix compiler warnings, mostly about unused variables.

	* src/helper/sp-canvas-util.cpp:
	Fix what I and someone else considered to be an obvious typo.  The
	function in question isn't used, however, so it's a bit difficult
	to test.

	* src/libnrtype/nr-rasterfont.cpp:
	Fix a warning wrt a cast from NR::Matrix to NRMatrix.

	* src/sp-shape.cpp:
	Fix bug #935758.
	

2004-04-14  Ted Gould <ted@gould.cx>

	* src/file.cpp, dialogs/filedialog.cpp:
	Making it so that the filename will get placed in the save as dialog
	if there is a name for the file.  Otherwise the last save directory
	is used (properly now)

2004-04-15  MenTaLguY <mental@rydia.net>

	* most files in src/: removed many old "compatable" struct typedefs

	* src/libarikkei/arikkei-dict.cpp, src/libarikkei/arikkei-dict.h:
	  removed unused arikkei files

	* configure.in: added gtkmm dependency

2004-04-14  Kees Cook <kees@outflux.net>

	* src/helper/unit-menu.cpp: Turns out I found a 2nd bug while
	  investigating patch 934358.  I've applied this patch again, which gives
	  us the entire fix.
	* src/draw-context.cpp: Investigated patch 934351 from cth103.  Applied a
	  slight variation to conform to the function calling styles of that code.
	* configure.in: Implemented gcc version test for >= 3.0.0
	* src/file.cpp, src/interface.cpp, share/icons/icons.svg, src/verbs.cbb:
	  finished "File / Revert" implementation.  Found a memory leak in
	  "file_save".  Added more sanity checking to "sp_file_revert" and more
	  status messages.
	* src/main.cpp, src/file.h, src/file.cpp: removed redundant code, implemented
	  in "sp_file_open".

2004-04-13  Kees Cook <kees@outflux.net>

	* tools-version.sh: added a possible fix for BSDish tools.
	* configure.in, share/patterns/Makefile.am: inkscape janitor strikes
	  again!  This is a quick cleanup to Ted's new directories.  Looks
	  like "patterns" got left out.
	* share/clipart/.cvsignore, share/templates/.cvsignore,
	  share/examples/.cvsignore, share/fonts/.cvsignore,
	  share/gradients/.cvsignore, share/keyboards/.cvsignore,
	  share/palettes/.cvsignore, share/patterns/.cvsignore:
	  Added Makefile build-cruft to .cvsignores.
	* src/helper/unit-menu.cpp: applied a variation to patch 934358 from cth103
	  to fix grid unit changing bug.
	* configure.in: fixed capitalization of "libpng" to avoid confusion.
	* src/sp-namedview.cpp, src/document.cpp, src/document.h, src/file.cpp,
	  src/file.h, src/document-undo.cpp, src/interface.cpp, src/verbs.cpp,
	  src/verbs.h:
	  Newly opened files will only create new windows if the current document
	  is untouched.  (RFE#928517)
	  Added support for future "File/Revert" handling.  Needs
	  a little more support in the SPDocument structure.  See notes in
	  "src/file.cpp", function "sp_file_revert_dialog".

2004-04-13  Ted Gould <ted@gould.cx>

	* configure.in, share/Makefile.am, share/clipart/Makefile.am,
	  share/examples/Makefile.am, share/fonts/Makefile.am
	  share/gradients/Makefile.am, share/keyboards/Makefile.am
	  share/markers/Makefile.am, share/palettes/Makefile.am
	  share/screens/Makefile.am, share/templates/Makefile.am:
	Making it so that the clipart and everything else gets put in
	the tarball, and also get installed in the share directory.  Many
	of these have just 'README' files, but they now have good place-
	holders for further development.

2004-04-12  Kees Cook <kees@outflux.net>

	* src/dialogs/stroke-style.cpp, src/Makefile.am, src/dialogs/Makefile.am,
	  src/widgets/Makefile.am, configure.in: fixed up INKSCAPE_*DIR paths so CVS
	  will compile happily for me.  This way if paths change, files will be
	  recompiled.  The old way would let configure run again (changing the
	  datadir path) without forcing a recompile, which could break the
	  compiled paths.

2004-04-13  John Cliff <simarilius@yahoo.com>
	* src/sp-shape.cpp, src/dialogs/stroke-style.cpp:
	Couple of changes to marker related code, mid and end markers now point in correct 
	direction, turning off start markers behaves correctly.
	This follows on from changes made by me and Carl Hetherington that were commited 
	yesterday to 
	src/inkscape-stock.cpp, src/sp-item.cpp, src/sp-marker.cpp, src/sp-shape.cpp,
	src/style.cpp, src/style.h, src/dialogs/stroke-style.cpp 
	to implement marker UI and fixes to the marker rendering code.

2004-04-11  Ted Gould <ted@gould.cx>

	* src/extension/system.cpp, src/extension/internal/eps-out.cpp
	  src/extension/internal/eps-out.h:
	First pass at a file save dialog with EPS output.  The dialog
	sets the bounding box in the file.  Comments encouraged.

2004-04-11  Ted Gould <ted@gould.cx>

	* src/file.cpp, src/main.cpp, src/print.cpp, src/extension/init.cpp,
	  src/extension/init.h, src/extension/system.cpp, src/extension/system.h,
	  src/extension/implementation/script.cpp, src/extension/internal/eps-out.cpp,
	  src/extension/internal/gnome.cpp, src/extension/internal/ps-out.cpp,
	  src/extension/internal/ps.cpp, src/extension/internal/svg.cpp,
	  src/extension/internal/win32.cpp:
	Change alot of files, but small changes.  Basically just took
	system.cpp and init.cpp and finally ported them to the Inkscape::
	Extension namespace.  Cleaned up the code in them a bunch, it is
	much easier to read now!  All the other files are just referencing
	these changes.

2004-04-11  Kees Cook <kees@outflux.net>

	* src/verbs.h, src/verbs.cpp, src/interface.cpp, src/interface.h: replaced
	  the rest of the missing menu verbs: "View New", "Cleanup".  Created
	  generic function to add icons to a given menu item (for submenu icons
	  mostly).
	* share/icons/icons.svg: added "selection_cleanup", "selection_deselect",
	  "selection_select_all".  Corrected "view_new" and "selection_smooth",
	  "dialog_toggle", "dialog_tool_options", "file_open_recent".
	* src/selection-chemistry.cpp, src/selection-chemistry.h: renamed
	  "selection_cleanup" function.

2004-04-11  Jon Phillip <jon@rejon.org>

	* Makefile.mingw share/Makefile.am src/Makefile.am 
	  share/markers/Makefile.am share/markers/.cvsignore config.h.mingw 
	  configure.in: 
	  Added the proper infrastructure to get files to the right location for 
	  markers.

	* share/tutorials/tipsandtricks.svg: Deleted the URL trick because it no 
	  longer works or something.

2004-04-11  Kees Cook <kees@outflux.net>

	* src/verbs.h, src/verbs.cpp: added verbs for the Help and Tutorials menus.
	* src/interface.cpp: replaced contents of sp_ui_menu_help to use new verbs.
	* src/help.h, src/help.cpp: replaced sp_help_keys with more generic
	  sp_help_open_screen, similar to sp_help_open_tutorial.
	* share/icons/icons.svg: created really ugly "help_tutorials" and
	  "help_keys" icons.  The "help_keys" one needs the most help.  :)

2004-04-09  Ted Gould <ted@gould.cx>

	* share/extensions/Makefile.am, share/extensions/epsi_output.inkmod,
	  share/extensions/ps2epsi.sh, src/extension/extension.cpp,
	  src/extension/extension.h, src/extension/init.cpp,
	  src/extension/implementation/implementation.cpp,
	  src/extension/implementation/implementation.h,
	  src/extension/implementation/script.cpp,
	  src/extension/implementation/script.h,
	  src/extension/internal/Makefile.am, src/extension/internal/eps-out.cpp,
	  src/extension/internal/eps-out.h, src/extension/internal/ps.cpp:

	  Okay, these are some changes that I've had in my directory for
	  a little while.

	  1) adding the basics of checking extensions.  This will allow
	     them to remove themselves based on their dependencies failing.

	  2) Adding the concepts of a 'helper extension' to scripts.  This
	     allows them to use other extensions for handling the data, so
	     they don't have to deal with SVG directly - Inkscape will
	     build the pipeline.  An example of this is the epsi output.

	  3) Adding the bounding box change provided by Carl Hetherington
	     to the Postscript output.  The EPS output plugin sets this, so
	     now EPSes have smaller bounding boxes.  A GUI needs to be
	     written for this setting.

2004-04-08  MenTaLguY <mental@rydia.net>

	* configure.in, src/svg/ftos.cpp: fix for OS X build

	* src/extensions/internal.ps.cpp: crash fix

2004-04-07  MenTaLguY <mental@rydia.net>

	* src/xml/repr.cpp: adjusted the advertising comment in the default
	  document template (we need a real default document template, btw)

	* src/svg/ftos.cpp, src/svg/itos.cpp, src/svg/round.cpp,
	  src/svg/ftos.h, src/svg/stringstream.h: incorporated Bryce's number
	  serializing code (disabled for now, due to the impending release)

	* src/dialogs/stroke-style.cpp, src/dialogs/sp-shape.cpp:
	  nuked unused variables

2004-04-07  bulia byak <bulia@users.sourceforge.net>

	* icons.svg: Alignment fix

	* src/select-toolbar.cpp: Swapped rotate buttons

	* share/tutorials/: Cleanup, added Russian translation of basic

	* extension/extension.cpp extension/system.cpp extension/internal/ps.cpp
	extension/implementation/script/cpp: Fixes to make non-ascii filenames work again

	* src/verbs.cpp: Remove xpm icon that causes trouble on win32

	* share/examples/: new gradient.svg, tiger.svgz, cleanup

	* src/widgets/gradient-vector.cpp: Crash fix: loading new gradient into the
	editor does not completely reset it

	* share/icons/icons.svg: New dialog icons, draw tool icons, changed colors

	* src/dialogs/align.cpp src/helper/bezier-utils.cpp: remove pjrm's debug output 

	* share/tutorials/: SVG cleanup: remove unused font properties, wrong radius
	paths in ellipses (leftovers from old versions). Expanded & updated tips & tricks.

	* file.cpp: Set uri on save in one place; save 'offcially' from here only

	* system.cpp system.h: Remove redundant uri-setting on open and save, add
	official arg to sp_module_system_save to prevent docname/docbase changing on
	temporary saves

	* many files: _() fixes, edits in labels, messages, tooltips, mnemonics

	* src/inkscape.cpp: remove redundancy in error messages for failing to load prefs

	* share/extensions src/extension/internal: Renaming file formats to include (*.ext)

	* src/interface.cpp src/dialogs/filedialog.cpp: Transientize, make modal
	open/save dialogs, ditto for warning overwrite and make it unresizeable

	* src/dialogs/xml-tree.cpp: Do not deselect item on canvas when a non-selectable
	thing is highlighted in xml editor

	* src/sp-guide.cpp: Guide position updated after undo

	* src/widgets/sp-xmlview-attr-list.cpp: Max length of viewable attributes
	increased

	* many files: Adib's svgostringstream patches to remove printfs

	* src/selection-chemistry.cpp: Crash fix when pasting style to an object that
	has none (e.g. group)

	* src/knot.cpp: Knot dragging autoscrolls

	* src/sp-text.cpp src/text-context.cpp: Cursor movements autoscroll

	* src/desktop.h src/desktop.cpp: autoscrollspeed can be overridden in call to
	sp_desktop_scroll_to_point

	* src/text-context.cpp src/sp-text.cpp: Text cursor made inverse. Initial cursor
	after click is no longer horizontal.

	* src/helper/sp-ctrlline.cpp: Always-visible inversion for ctrlline

	* src/libnrtype/nr-type-w32.cpp: Fix stretch and variant on win32 

	* src/widgets/gradient-vector.cpp: Undo fix; new stop takes average of its
	neighbors' colors; is between stops even when the last stop is selected

2004-04-06  Ted Gould <ted@gould.cx>

	* src/file.cpp, src/dialogs/filedialog.cpp, src/extension/extension.cpp,
	src/extension/system.cpp:
	Moving code around so that the filename extension gets put on by
	the extension that is saving the file.  This adds a couple complications
	in that the extension now needs to check for overwriting the file
	and also set the document URI.  Better overall, but a PITA.

2004-04-05  njh <njh@mail.csse.monash.edu.au>

	* debian/rules,debian/control: applied patch from Kees Cook to remove
	obsolete libraries, and to tidy things up a tad.

2004-04-04  Ted Gould <ted@gould.cx>

	* src/main.cpp, src/extension/extension.cpp, src/extension/system.cpp:
	Now the input autodetect will try the SVG filter if the autodetect
	fails.  This was done by the command line, but now it is done
	everywhere.

2004-04-04  MenTaLguY <mental@rydia.net>

	* src/xml/repr-io.cpp, src/xml/repr.cpp, src/xml/repr.h:
	Take the full list of document node children from libxml, and
	append them in the correct order.  This fixes bug #929348.

	* src/xml/repr-io.cpp, src/xml/repr.cpp, src/xml/repr-private.h:
	Added API for coping with comments at the root level (i.e. siblings
	of the root XML node), and made corresponding changes to the repr-io
	code.  In theory this should be enough to preserve them upon loading, 
	though in practice it still doesn't appear to be working (bug #929348).
	Is there some libxml thing we need to do?

2004-04-04  Ted Gould <ted@gould.cx>

	* a bunch of files
	Sorry, I seem to be in some delay getting e-mail.  Anyway, a few
	files were changed to add in a new parameter 'dataloss'  Basically
	this signifies that a format was used to save that may not save
	the whole document and thus, a pop-up is elevated on close to signal
	that you might want to 'really save' this document.

2004-04-03  Ted Gould <ted@gould.cx>

	* share/extensions/svgz_input.inkmod, src/file.cpp,
	  src/extension/extension.cpp, src/extension/internal/svg.cpp:
	Making it so that input extensions can specify the output extension
	that gets used to save them.  If this field isn't filled in, the value
	gets set to NULL, and then the Save As dialog is used instead of
	just trying to save.

2004-04-03  Ted Gould <ted@gould.cx>

	* src/file.cpp, src/main.cpp, src/extension/extension.cpp,
	  src/extension/extension.h, src/extension/system.cpp,
	  src/extension/internal/svg.cpp:
	Fixing the output_extension flag to not be saved in a file, but also
	to be able to be specified by the input module.  Also, this fixes
	the commandline processing of files to make them use the extension
	system.

2004-04-02  Ted Gould <ted@gould.cx>

	* src/file.cpp, src/extension/db.cpp, src/extension/internal/svg.cpp:
	Changing it so that SVG documents open and default to with
	extension namespace.  Also, autodetect is reenabled.

2004-04-03  Peter Moulder <pmoulder@mail.csse.monash.edu.au>

	* src/helper/bezier-utils.cpp (NewtonRaphsonRootFind): Fix my
	previous commit.

2004-04-02  Ted Gould <ted@gould.cx>

	* share/extensions/svgz_output.inkmod, src/main.cpp, src/print.cpp,
	  src/extension/init.cpp, src/extension/implementation/script.cpp,
	  src/extension/implementation/script.h,
	  src/extension/internal/Makefile.am, src/extension/internal/ps-out.cpp,
	  src/extension/internal/ps-out.h, src/extension/internal/ps.cpp:
	Fixing the commandline printing.  This required fixing both the
	print driver to handle the newer extensions stuff.  It seems
	happy now.  I went ahead and implemented save as postscript
	while I was at it.

2004-04-02  Peter Moulder  <pmoulder@mail.csse.monash.edu.au>

	* src/helper/bezier-utils.cpp (NewtonRaphsonRootFind): Ensure that the
	"improved" value is never worse than the previous guess.

	* src/helper/bezier-utils.cpp:
	Greater CodingStyle conformance, mainly whitespace changes.

	* src/helper/bezier-utils.cpp (sp_bezier_fit_cubic_full):
	Always reparameterize between generate_bezier and calc_max_error.
	Switch from discouraged alloca (see man page) to g_new, at cost of
	some extra g_free calls in the code.
	(reparameterize): Do in-place modification.

	* src/helper/bezier-utils-test.cpp:
	Add tests for generate_bezier, sp_bezier_fit_cubic_full.
	Change to a simpler test bezier.

	* src/helper/bezier-utils.cpp (sp_darray_left_tangent,
	sp_darray_right_tangent):
	Switch to using just the two end points for calculating the gradient.
	(The old code could sometimes cause g_warning's.) 
	Correct the documentation of requirements.
	(sp_darray_center_tangent): Similarly remove the #if'ed out code for
	looking at more than two points.

See doc/Changelog_archive.txt for older entries
	
# Local Variables:
# tab-width:8
# indent-tabs-mode:t
# End:
# vim: tabstop=4:noexpandtab:shiftwidth=4
